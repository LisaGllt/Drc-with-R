<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3&nbsp; Modélisation de la courbe dose-réponse - Exemple – Faire des courbes dose-réponse avec R et drc</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../quarto/A_Theorie_courbe_dose_reponse.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-a1a99922ddb087a1e1a87053fc057468.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-3c3f95197d04638c206bc2c48134e1f1.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../quarto/B_Courbe_dose_reponse_avec_R.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Modélisation de la courbe dose-réponse - Exemple</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Faire des courbes dose-réponse avec R et drc</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Objectifs de ce repo</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quarto/A_Theorie_courbe_dose_reponse.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Principe des courbes dose-réponse</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../quarto/B_Courbe_dose_reponse_avec_R.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Modélisation de la courbe dose-réponse - Exemple</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#etape-1---importer-et-visualiser-ses-données" id="toc-etape-1---importer-et-visualiser-ses-données" class="nav-link active" data-scroll-target="#etape-1---importer-et-visualiser-ses-données"><span class="header-section-number">3.1</span> Etape 1 - Importer et visualiser ses données</a></li>
  <li><a href="#etape-2---appliquer-le-modèle-de-hill-aux-données" id="toc-etape-2---appliquer-le-modèle-de-hill-aux-données" class="nav-link" data-scroll-target="#etape-2---appliquer-le-modèle-de-hill-aux-données"><span class="header-section-number">3.2</span> Etape 2 - Appliquer le modèle de Hill aux données</a></li>
  <li><a href="#etape-3---visualisation-des-résultats-du-modèle" id="toc-etape-3---visualisation-des-résultats-du-modèle" class="nav-link" data-scroll-target="#etape-3---visualisation-des-résultats-du-modèle"><span class="header-section-number">3.3</span> Etape 3 - Visualisation des résultats du modèle</a></li>
  <li><a href="#etape-4---validation-du-modèle" id="toc-etape-4---validation-du-modèle" class="nav-link" data-scroll-target="#etape-4---validation-du-modèle"><span class="header-section-number">3.4</span> Etape 4 - Validation du modèle</a></li>
  <li><a href="#etape-5---détermination-de-la-noec-et-de-la-loec" id="toc-etape-5---détermination-de-la-noec-et-de-la-loec" class="nav-link" data-scroll-target="#etape-5---détermination-de-la-noec-et-de-la-loec"><span class="header-section-number">3.5</span> Etape 5 - Détermination de la NOEC et de la LOEC</a>
  <ul class="collapse">
  <li><a href="#pour-la-croissance" id="toc-pour-la-croissance" class="nav-link" data-scroll-target="#pour-la-croissance"><span class="header-section-number">3.5.1</span> Pour la croissance</a></li>
  <li><a href="#pour-la-reproduction" id="toc-pour-la-reproduction" class="nav-link" data-scroll-target="#pour-la-reproduction"><span class="header-section-number">3.5.2</span> Pour la reproduction</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Modélisation de la courbe dose-réponse - Exemple</span></h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-1"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="1">1</button><span id="annotated-cell-1-1" class="code-annotation-target"><a href="#annotated-cell-1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse); <span class="fu">library</span>(drc); <span class="fu">library</span>(readxl); <span class="fu">library</span>(nord)</span>
<span id="annotated-cell-1-2"><a href="#annotated-cell-1-2" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="2">2</button><span id="annotated-cell-1-3" class="code-annotation-target"><a href="#annotated-cell-1-3" aria-hidden="true" tabindex="-1"></a>Nord_frost <span class="ot">&lt;-</span> <span class="fu">nord</span>(<span class="at">palette =</span> <span class="st">"frost"</span>)</span>
<span id="annotated-cell-1-4"><a href="#annotated-cell-1-4" aria-hidden="true" tabindex="-1"></a>Nord_aurora <span class="ot">&lt;-</span> <span class="fu">nord</span>(<span class="at">palette =</span> <span class="st">"aurora"</span>)</span>
<span id="annotated-cell-1-5"><a href="#annotated-cell-1-5" aria-hidden="true" tabindex="-1"></a>Nord_polar <span class="ot">&lt;-</span> <span class="fu">nord</span>(<span class="at">palette =</span> <span class="st">"polarnight"</span>)</span>
<span id="annotated-cell-1-6"><a href="#annotated-cell-1-6" aria-hidden="true" tabindex="-1"></a>Nord_snow <span class="ot">&lt;-</span> <span class="fu">nord</span>(<span class="at">palette =</span> <span class="st">"snowstorm"</span>)</span>
<span id="annotated-cell-1-7"><a href="#annotated-cell-1-7" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-1" data-target-annotation="3">3</button><span id="annotated-cell-1-8" class="code-annotation-target"><a href="#annotated-cell-1-8" aria-hidden="true" tabindex="-1"></a>col_croiss <span class="ot">&lt;-</span> Nord_frost[<span class="dv">2</span>]</span>
<span id="annotated-cell-1-9"><a href="#annotated-cell-1-9" aria-hidden="true" tabindex="-1"></a>col_repro <span class="ot">&lt;-</span> Nord_frost[<span class="dv">4</span>]</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-1" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="1" data-code-annotation="1">Packages utilisés ici</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="3,4,5,6" data-code-annotation="2">Palettes de couleurs sympa qui vient d’ici : https://www.nordtheme.com</span>
</dd>
<dt data-target-cell="annotated-cell-1" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-1" data-code-lines="8,9" data-code-annotation="3">Définition des couleurs pour nos endpoints</span>
</dd>
</dl>
</div>
</div>
<p>On s’intéresse à l’impact de la concentration en éther dans l’air (mg/L) sur la croissance et la reproduction des dragons.</p>
<section id="etape-1---importer-et-visualiser-ses-données" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="etape-1---importer-et-visualiser-ses-données"><span class="header-section-number">3.1</span> Etape 1 - Importer et visualiser ses données</h2>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-2"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="1">1</button><span id="annotated-cell-2-1" class="code-annotation-target"><a href="#annotated-cell-2-1" aria-hidden="true" tabindex="-1"></a>df_sim_croiss <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/Data_sim_croiss_dragon.xlsx"</span>)) <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="3">3</button><span id="annotated-cell-2-2" class="code-annotation-target"><a href="#annotated-cell-2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dose_f =</span> <span class="fu">as.factor</span>(Dose))</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="2">2</button><span id="annotated-cell-2-3" class="code-annotation-target"><a href="#annotated-cell-2-3" aria-hidden="true" tabindex="-1"></a>df_sim_repro <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"data/Data_sim_repro_dragon.xlsx"</span>)) <span class="sc">|&gt;</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-2" data-target-annotation="4">4</button><span id="annotated-cell-2-4" class="code-annotation-target"><a href="#annotated-cell-2-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Dose_f =</span> <span class="fu">as.factor</span>(Dose))</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-2" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="1" data-code-annotation="1">Importation des données de croissance de nos dragons</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="3" data-code-annotation="2">Importation des données de reproduction de nos dragons</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="2" data-code-annotation="3">Creation de <code>Dose_f</code>, de type factor</span>
</dd>
<dt data-target-cell="annotated-cell-2" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-2" data-code-lines="4" data-code-annotation="4">Creation de <code>Dose_f</code>, de type factor</span>
</dd>
</dl>
</div>
</div>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-3"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-3" data-target-annotation="1">1</button><span id="annotated-cell-3-1" class="code-annotation-target"><a href="#annotated-cell-3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_sim_croiss)</span>
<span id="annotated-cell-3-2"><a href="#annotated-cell-3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_sim_repro)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-3" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-3" data-code-lines="1,2" data-code-annotation="1">Affiche les 5 premières lignes</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 4
     ID  Dose nb_rep Txcroiss
  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
1     1     0      1     34.3
2     2     0      2     35.4
3     3     0      3     39.2
4     4     0      4     23.6
5     5     0      5     25.5
6     6     5      1     24.4
# A tibble: 6 × 4
     ID  Dose nb_rep  Oeuf
  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;
1     1  0         1  22.5
2     2  0         2  20.5
3     3  0         3  12.7
4     4  0         4  18.3
5     5  0         5  16.3
6     6  0.25      1  14.2</code></pre>
</div>
</div>
<p>On a des jeux de données avec :</p>
<ul>
<li><code>ID</code> : Numéro unique du dragon</li>
<li><code>Nb_rep</code> : Numéro de réplicat par rapport à un dose donnée</li>
<li><code>Dose</code> : Dose d’exposition du dragon (mg/L)</li>
<li><code>Oeuf</code> : Le nombre d’oeuf produit par le dragon en 1 an</li>
<li><code>Txcroiss</code> : Le taux de croissance du dragon (kg/jour)</li>
</ul>
<p>Il serait bien de d’avoir des jeux de donnée avec la moyenne du taux de croissance et la moyenne du nombre d’oeuf produit par dose testée.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-4"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><button class="code-annotation-anchor" data-target-cell="annotated-cell-4" data-target-annotation="1">1</button><span id="annotated-cell-4-1" class="code-annotation-target"><a href="#annotated-cell-4-1" aria-hidden="true" tabindex="-1"></a>df_sim_croiss_mean <span class="ot">&lt;-</span> df_sim_croiss <span class="sc">|&gt;</span></span>
<span id="annotated-cell-4-2"><a href="#annotated-cell-4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aggregate</span>(Txcroiss <span class="sc">~</span> Dose, <span class="at">FUN =</span> mean)</span>
<span id="annotated-cell-4-3"><a href="#annotated-cell-4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-4-4"><a href="#annotated-cell-4-4" aria-hidden="true" tabindex="-1"></a>df_sim_repro_mean <span class="ot">&lt;-</span> df_sim_repro <span class="sc">|&gt;</span></span>
<span id="annotated-cell-4-5"><a href="#annotated-cell-4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aggregate</span>(Oeuf <span class="sc">~</span> Dose, <span class="at">FUN =</span> mean)</span>
<span id="annotated-cell-4-6"><a href="#annotated-cell-4-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-4-7"><a href="#annotated-cell-4-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_sim_croiss_mean)</span>
<span id="annotated-cell-4-8"><a href="#annotated-cell-4-8" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_sim_repro_mean)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-4" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-4" data-code-lines="1,2,4,5" data-code-annotation="1">Creation de nouveaux dataframes avec le taux de croissance et le nombre d’oeufs produits moyen par dose.</span>
</dd>
</dl>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>       Dose Txcroiss
1   0.00000  31.5948
2   5.00000  22.9434
3  10.77217  33.6770
4  23.20794  29.5730
5  50.00000  22.2080
6 107.72173  12.3238
        Dose  Oeuf
1  0.0000000 18.06
2  0.2500000 16.94
3  0.7905694 18.82
4  2.5000000 19.32
5  7.9056942 12.26
6 25.0000000  6.62</code></pre>
</div>
</div>
<p>Maintenant qu’on a importé nos données, on peut les visualiser de différentes façons.</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">Dots</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Boxplot</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>On peut faire un graphique avec deux types de points : Les points correspondant aux réplicats et les points correspondant à la moyenne pour une dose donnée (<a href="#fig-datapoint" class="quarto-xref">Figure&nbsp;<span>3.1</span></a>).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-31"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-31-1"><a href="#annotated-cell-31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres des graphiques </span></span>
<span id="annotated-cell-31-2"><a href="#annotated-cell-31-2" aria-hidden="true" tabindex="-1"></a>size_mean <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="annotated-cell-31-3"><a href="#annotated-cell-31-3" aria-hidden="true" tabindex="-1"></a>alpha_rep <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="annotated-cell-31-4"><a href="#annotated-cell-31-4" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="1">1</button><span id="annotated-cell-31-5" class="code-annotation-target"><a href="#annotated-cell-31-5" aria-hidden="true" tabindex="-1"></a>p_C <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="annotated-cell-31-6"><a href="#annotated-cell-31-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-31-7"><a href="#annotated-cell-31-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Nuage de points avec un point par réplicat</span></span>
<span id="annotated-cell-31-8"><a href="#annotated-cell-31-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="2">2</button><span id="annotated-cell-31-9" class="code-annotation-target"><a href="#annotated-cell-31-9" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> df_sim_croiss,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="3">3</button><span id="annotated-cell-31-10" class="code-annotation-target"><a href="#annotated-cell-31-10" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="annotated-cell-31-11"><a href="#annotated-cell-31-11" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> Dose,</span>
<span id="annotated-cell-31-12"><a href="#annotated-cell-31-12" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> Txcroiss</span>
<span id="annotated-cell-31-13"><a href="#annotated-cell-31-13" aria-hidden="true" tabindex="-1"></a>      ),</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="4">4</button><span id="annotated-cell-31-14" class="code-annotation-target"><a href="#annotated-cell-31-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> alpha_rep,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="5">5</button><span id="annotated-cell-31-15" class="code-annotation-target"><a href="#annotated-cell-31-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> col_croiss</span>
<span id="annotated-cell-31-16"><a href="#annotated-cell-31-16" aria-hidden="true" tabindex="-1"></a>      )<span class="sc">+</span></span>
<span id="annotated-cell-31-17"><a href="#annotated-cell-31-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-31-18"><a href="#annotated-cell-31-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Nuage de points correspondant aux moyennes par dose</span></span>
<span id="annotated-cell-31-19"><a href="#annotated-cell-31-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="annotated-cell-31-20"><a href="#annotated-cell-31-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> df_sim_croiss_mean,</span>
<span id="annotated-cell-31-21"><a href="#annotated-cell-31-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="annotated-cell-31-22"><a href="#annotated-cell-31-22" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> Dose,</span>
<span id="annotated-cell-31-23"><a href="#annotated-cell-31-23" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> Txcroiss</span>
<span id="annotated-cell-31-24"><a href="#annotated-cell-31-24" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="annotated-cell-31-25"><a href="#annotated-cell-31-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="annotated-cell-31-26"><a href="#annotated-cell-31-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> col_croiss,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="6">6</button><span id="annotated-cell-31-27" class="code-annotation-target"><a href="#annotated-cell-31-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> size_mean</span>
<span id="annotated-cell-31-28"><a href="#annotated-cell-31-28" aria-hidden="true" tabindex="-1"></a>      )<span class="sc">+</span></span>
<span id="annotated-cell-31-29"><a href="#annotated-cell-31-29" aria-hidden="true" tabindex="-1"></a>  </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="7">7</button><span id="annotated-cell-31-30" class="code-annotation-target"><a href="#annotated-cell-31-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()<span class="sc">+</span></span>
<span id="annotated-cell-31-31"><a href="#annotated-cell-31-31" aria-hidden="true" tabindex="-1"></a>  </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="8">8</button><span id="annotated-cell-31-32" class="code-annotation-target"><a href="#annotated-cell-31-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="annotated-cell-31-33"><a href="#annotated-cell-31-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Dose en éther (mg/L)"</span>,</span>
<span id="annotated-cell-31-34"><a href="#annotated-cell-31-34" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Taux de croissance des dragons (kg/jour)"</span></span>
<span id="annotated-cell-31-35"><a href="#annotated-cell-31-35" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="9">9</button><span id="annotated-cell-31-36" class="code-annotation-target"><a href="#annotated-cell-31-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="annotated-cell-31-37"><a href="#annotated-cell-31-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-31-38"><a href="#annotated-cell-31-38" aria-hidden="true" tabindex="-1"></a>p_R <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span> </span>
<span id="annotated-cell-31-39"><a href="#annotated-cell-31-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-31-40"><a href="#annotated-cell-31-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Nuage de points avec un point par réplicat</span></span>
<span id="annotated-cell-31-41"><a href="#annotated-cell-31-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="annotated-cell-31-42"><a href="#annotated-cell-31-42" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> df_sim_repro, </span>
<span id="annotated-cell-31-43"><a href="#annotated-cell-31-43" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>( </span>
<span id="annotated-cell-31-44"><a href="#annotated-cell-31-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> Dose, </span>
<span id="annotated-cell-31-45"><a href="#annotated-cell-31-45" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> Oeuf </span>
<span id="annotated-cell-31-46"><a href="#annotated-cell-31-46" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="annotated-cell-31-47"><a href="#annotated-cell-31-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> alpha_rep, </span>
<span id="annotated-cell-31-48"><a href="#annotated-cell-31-48" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> col_repro</span>
<span id="annotated-cell-31-49"><a href="#annotated-cell-31-49" aria-hidden="true" tabindex="-1"></a>      )<span class="sc">+</span></span>
<span id="annotated-cell-31-50"><a href="#annotated-cell-31-50" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-31-51"><a href="#annotated-cell-31-51" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Nuage de points correspondant aux moyennes par dose</span></span>
<span id="annotated-cell-31-52"><a href="#annotated-cell-31-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="annotated-cell-31-53"><a href="#annotated-cell-31-53" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> df_sim_repro_mean,</span>
<span id="annotated-cell-31-54"><a href="#annotated-cell-31-54" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(</span>
<span id="annotated-cell-31-55"><a href="#annotated-cell-31-55" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> Dose,</span>
<span id="annotated-cell-31-56"><a href="#annotated-cell-31-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> Oeuf</span>
<span id="annotated-cell-31-57"><a href="#annotated-cell-31-57" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="annotated-cell-31-58"><a href="#annotated-cell-31-58" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> <span class="dv">1</span>,</span>
<span id="annotated-cell-31-59"><a href="#annotated-cell-31-59" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> col_repro,</span>
<span id="annotated-cell-31-60"><a href="#annotated-cell-31-60" aria-hidden="true" tabindex="-1"></a>      <span class="at">size =</span> size_mean</span>
<span id="annotated-cell-31-61"><a href="#annotated-cell-31-61" aria-hidden="true" tabindex="-1"></a>      )<span class="sc">+</span></span>
<span id="annotated-cell-31-62"><a href="#annotated-cell-31-62" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-31-63"><a href="#annotated-cell-31-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()<span class="sc">+</span></span>
<span id="annotated-cell-31-64"><a href="#annotated-cell-31-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-31-65"><a href="#annotated-cell-31-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>( </span>
<span id="annotated-cell-31-66"><a href="#annotated-cell-31-66" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Dose en éther (mg/L)"</span>,</span>
<span id="annotated-cell-31-67"><a href="#annotated-cell-31-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Nombre d'oeufs produits par les dragons (#)"</span></span>
<span id="annotated-cell-31-68"><a href="#annotated-cell-31-68" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="annotated-cell-31-69"><a href="#annotated-cell-31-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="annotated-cell-31-70"><a href="#annotated-cell-31-70" aria-hidden="true" tabindex="-1"></a></span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-31" data-target-annotation="10">10</button><span id="annotated-cell-31-71" class="code-annotation-target"><a href="#annotated-cell-31-71" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p_C <span class="sc">+</span> p_R <span class="sc">+</span></span>
<span id="annotated-cell-31-72"><a href="#annotated-cell-31-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>)</span>
<span id="annotated-cell-31-73"><a href="#annotated-cell-31-73" aria-hidden="true" tabindex="-1"></a>p </span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-31" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="5" data-code-annotation="1">Initialisation du graphique</span>
</dd>
<dt data-target-cell="annotated-cell-31" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="9" data-code-annotation="2">Données utilisées pour ce nuage de points</span>
</dd>
<dt data-target-cell="annotated-cell-31" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="10,11,12,13" data-code-annotation="3">Axes à utiliser pour ce nuage de points</span>
</dd>
<dt data-target-cell="annotated-cell-31" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="14" data-code-annotation="4">Transparence des points</span>
</dd>
<dt data-target-cell="annotated-cell-31" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="15" data-code-annotation="5">Couleur des points</span>
</dd>
<dt data-target-cell="annotated-cell-31" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="27" data-code-annotation="6">Taille des points pour ce nuage de points</span>
</dd>
<dt data-target-cell="annotated-cell-31" data-target-annotation="7">7</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="30" data-code-annotation="7">Axe des x mis en échelle log (logarithme base 10)</span>
</dd>
<dt data-target-cell="annotated-cell-31" data-target-annotation="8">8</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="32,33,34,35" data-code-annotation="8">Titres des axes</span>
</dd>
<dt data-target-cell="annotated-cell-31" data-target-annotation="9">9</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="36" data-code-annotation="9">Aspect général du graphique</span>
</dd>
<dt data-target-cell="annotated-cell-31" data-target-annotation="10">10</dt>
<dd>
<span data-code-cell="annotated-cell-31" data-code-lines="71,72" data-code-annotation="10">Les deux graphiques sont mis côte à côte</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div id="fig-datapoint" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-datapoint-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="B_Courbe_dose_reponse_avec_R_files/figure-html/fig-datapoint-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-datapoint-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.1: Taux de croissance et production d’oeufs des dragons en fonction de la dose d’éther
</figcaption>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p>Ou on peut faire des bowplots, où la dose est bien une catégorie et non un nombre (<a href="#fig-databox" class="quarto-xref">Figure&nbsp;<span>3.2</span></a>).</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-32"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-32-1"><a href="#annotated-cell-32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres des graphiques </span></span>
<span id="annotated-cell-32-2"><a href="#annotated-cell-32-2" aria-hidden="true" tabindex="-1"></a>alpha_box <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="annotated-cell-32-3"><a href="#annotated-cell-32-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-32-4"><a href="#annotated-cell-32-4" aria-hidden="true" tabindex="-1"></a>p_C <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="annotated-cell-32-5"><a href="#annotated-cell-32-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> df_sim_croiss,                    </span>
<span id="annotated-cell-32-6"><a href="#annotated-cell-32-6" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(                          </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-32" data-target-annotation="1">1</button><span id="annotated-cell-32-7" class="code-annotation-target"><a href="#annotated-cell-32-7" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">as.factor</span>(<span class="fu">round</span>(Dose,<span class="dv">1</span>)),</span>
<span id="annotated-cell-32-8"><a href="#annotated-cell-32-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> Txcroiss                           </span>
<span id="annotated-cell-32-9"><a href="#annotated-cell-32-9" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="annotated-cell-32-10"><a href="#annotated-cell-32-10" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span>                                 </span>
<span id="annotated-cell-32-11"><a href="#annotated-cell-32-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-32-12"><a href="#annotated-cell-32-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Boxplot</span></span>
<span id="annotated-cell-32-13"><a href="#annotated-cell-32-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>( </span>
<span id="annotated-cell-32-14"><a href="#annotated-cell-32-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> alpha_box,                          </span>
<span id="annotated-cell-32-15"><a href="#annotated-cell-32-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> col_croiss,                          </span>
<span id="annotated-cell-32-16"><a href="#annotated-cell-32-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> col_croiss</span>
<span id="annotated-cell-32-17"><a href="#annotated-cell-32-17" aria-hidden="true" tabindex="-1"></a>      )<span class="sc">+</span></span>
<span id="annotated-cell-32-18"><a href="#annotated-cell-32-18" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-32-19"><a href="#annotated-cell-32-19" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Points</span></span>
<span id="annotated-cell-32-20"><a href="#annotated-cell-32-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(</span>
<span id="annotated-cell-32-21"><a href="#annotated-cell-32-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">binaxis=</span><span class="st">'y'</span>, </span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-32" data-target-annotation="2">2</button><span id="annotated-cell-32-22" class="code-annotation-target"><a href="#annotated-cell-32-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">stackdir=</span><span class="st">'center'</span>,</span>
<span id="annotated-cell-32-23"><a href="#annotated-cell-32-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">dotsize=</span><span class="fl">0.7</span>, </span>
<span id="annotated-cell-32-24"><a href="#annotated-cell-32-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span><span class="fl">0.9</span>,                          </span>
<span id="annotated-cell-32-25"><a href="#annotated-cell-32-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_croiss,</span>
<span id="annotated-cell-32-26"><a href="#annotated-cell-32-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> col_croiss</span>
<span id="annotated-cell-32-27"><a href="#annotated-cell-32-27" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="annotated-cell-32-28"><a href="#annotated-cell-32-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-32-29"><a href="#annotated-cell-32-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(                                         </span>
<span id="annotated-cell-32-30"><a href="#annotated-cell-32-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Dose en éther (mg/L)"</span>,              </span>
<span id="annotated-cell-32-31"><a href="#annotated-cell-32-31" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Taux de croissance des dragons (kg/jour)"</span></span>
<span id="annotated-cell-32-32"><a href="#annotated-cell-32-32" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span>                                             </span>
<span id="annotated-cell-32-33"><a href="#annotated-cell-32-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span>
<span id="annotated-cell-32-34"><a href="#annotated-cell-32-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-32-35"><a href="#annotated-cell-32-35" aria-hidden="true" tabindex="-1"></a>p_R <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="annotated-cell-32-36"><a href="#annotated-cell-32-36" aria-hidden="true" tabindex="-1"></a>      <span class="at">data =</span> df_sim_repro,                    </span>
<span id="annotated-cell-32-37"><a href="#annotated-cell-32-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">mapping =</span> <span class="fu">aes</span>(                          </span>
<span id="annotated-cell-32-38"><a href="#annotated-cell-32-38" aria-hidden="true" tabindex="-1"></a>        <span class="at">x =</span> <span class="fu">as.factor</span>(<span class="fu">round</span>(Dose,<span class="dv">1</span>)),                               </span>
<span id="annotated-cell-32-39"><a href="#annotated-cell-32-39" aria-hidden="true" tabindex="-1"></a>        <span class="at">y =</span> Oeuf                           </span>
<span id="annotated-cell-32-40"><a href="#annotated-cell-32-40" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="annotated-cell-32-41"><a href="#annotated-cell-32-41" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span>                              </span>
<span id="annotated-cell-32-42"><a href="#annotated-cell-32-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-32-43"><a href="#annotated-cell-32-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Boxplot</span></span>
<span id="annotated-cell-32-44"><a href="#annotated-cell-32-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(</span>
<span id="annotated-cell-32-45"><a href="#annotated-cell-32-45" aria-hidden="true" tabindex="-1"></a>      <span class="at">alpha =</span> alpha_box,                          </span>
<span id="annotated-cell-32-46"><a href="#annotated-cell-32-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">color =</span> col_repro,                          </span>
<span id="annotated-cell-32-47"><a href="#annotated-cell-32-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">fill =</span> col_repro</span>
<span id="annotated-cell-32-48"><a href="#annotated-cell-32-48" aria-hidden="true" tabindex="-1"></a>      )<span class="sc">+</span></span>
<span id="annotated-cell-32-49"><a href="#annotated-cell-32-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-32-50"><a href="#annotated-cell-32-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Points</span></span>
<span id="annotated-cell-32-51"><a href="#annotated-cell-32-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_dotplot</span>(</span>
<span id="annotated-cell-32-52"><a href="#annotated-cell-32-52" aria-hidden="true" tabindex="-1"></a>    <span class="at">binaxis=</span><span class="st">'y'</span>, </span>
<span id="annotated-cell-32-53"><a href="#annotated-cell-32-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">stackdir=</span><span class="st">'center'</span>, </span>
<span id="annotated-cell-32-54"><a href="#annotated-cell-32-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">dotsize=</span><span class="fl">0.7</span>, </span>
<span id="annotated-cell-32-55"><a href="#annotated-cell-32-55" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span><span class="fl">0.9</span>,                          </span>
<span id="annotated-cell-32-56"><a href="#annotated-cell-32-56" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_repro,</span>
<span id="annotated-cell-32-57"><a href="#annotated-cell-32-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> col_repro</span>
<span id="annotated-cell-32-58"><a href="#annotated-cell-32-58" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="annotated-cell-32-59"><a href="#annotated-cell-32-59" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="annotated-cell-32-60"><a href="#annotated-cell-32-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(                                         </span>
<span id="annotated-cell-32-61"><a href="#annotated-cell-32-61" aria-hidden="true" tabindex="-1"></a>    <span class="at">x =</span> <span class="st">"Dose en éther (mg/L)"</span>,              </span>
<span id="annotated-cell-32-62"><a href="#annotated-cell-32-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="st">"Nombre d'oeufs produits par les dragons (#)"</span></span>
<span id="annotated-cell-32-63"><a href="#annotated-cell-32-63" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span>                                             </span>
<span id="annotated-cell-32-64"><a href="#annotated-cell-32-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() </span>
<span id="annotated-cell-32-65"><a href="#annotated-cell-32-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-32-66"><a href="#annotated-cell-32-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-32-67"><a href="#annotated-cell-32-67" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p_C <span class="sc">+</span> p_R <span class="sc">+</span>                                </span>
<span id="annotated-cell-32-68"><a href="#annotated-cell-32-68" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>)                        </span>
<span id="annotated-cell-32-69"><a href="#annotated-cell-32-69" aria-hidden="true" tabindex="-1"></a>p </span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-32" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-32" data-code-lines="7" data-code-annotation="1">Le type de la variable dose doit être convertit en facteur</span>
</dd>
<dt data-target-cell="annotated-cell-32" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-32" data-code-lines="22" data-code-annotation="2">Disposition des points</span>
</dd>
</dl>
</div>
<div class="cell-output-display">
<div id="fig-databox" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-databox-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="B_Courbe_dose_reponse_avec_R_files/figure-html/fig-databox-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-databox-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.2: Taux de croissance et production d’oeufs des dragons en fonction de la dose d’éther
</figcaption>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="etape-2---appliquer-le-modèle-de-hill-aux-données" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="etape-2---appliquer-le-modèle-de-hill-aux-données"><span class="header-section-number">3.2</span> Etape 2 - Appliquer le modèle de Hill aux données</h2>
<p>Les modèles de Hill pour la croissance et la reproduction peuvent présenter des différences :</p>
<ul>
<li>Pour la <strong>reproduction</strong>, la réponse minimale est connue et fixée à 0, car il est impossible d’observer un nombre d’œufs négatif.</li>
<li>Pour la <strong>croissance</strong>, le taux minimal n’est pas toujours connu à l’avance, car il peut dépendre de facteurs biologiques et environnementaux.</li>
<li>La distribution des valeurs observées diffère entre les deux :
<ul>
<li>Le <strong>taux de croissance</strong> suit une distribution <strong>normale</strong>, car il résulte de variations continues influencées par de multiples facteurs.</li>
<li>La <strong>reproduction</strong> suit une distribution de <strong>Poisson</strong>, car elle repose sur un comptage d’événements discrets (nombre d’œufs produits).</li>
</ul></li>
</ul>
<p>Formellement, les modèles peuvent être écrit de la sorte avec <span class="math inline">\(Y_i\)</span> la réponse d’un individu <span class="math inline">\(i\)</span> exposé à une dose donnée :</p>
<p><span id="eq-drccroiss"><span class="math display">\[
\begin{aligned}
\text{Pour la croissance : }Y_i \sim \mathcal{N}(\text{Hill}(Dose_i), \sigma^2)
\end{aligned}
\tag{3.1}\]</span></span></p>
<p><span id="eq-drcrepro"><span class="math display">\[
\begin{aligned}
\text{Pour la reproduction : }Y_i \sim \mathcal{P}(\text{Hill}(Dose_i))
\end{aligned}
\tag{3.2}\]</span></span></p>
<p>La librairie <code>drc</code> peut maintenant être utilisée.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="annotated-cell-5"><pre class="sourceCode r code-annotation-code code-with-copy code-annotated"><code class="sourceCode r"><span id="annotated-cell-5-1"><a href="#annotated-cell-5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle pour la croissance</span></span>
<span id="annotated-cell-5-2"><a href="#annotated-cell-5-2" aria-hidden="true" tabindex="-1"></a>drc.croiss <span class="ot">&lt;-</span> <span class="fu">drm</span>(</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="1">1</button><span id="annotated-cell-5-3" class="code-annotation-target"><a href="#annotated-cell-5-3" aria-hidden="true" tabindex="-1"></a>  Txcroiss <span class="sc">~</span> Dose,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="2">2</button><span id="annotated-cell-5-4" class="code-annotation-target"><a href="#annotated-cell-5-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_sim_croiss,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="3">3</button><span id="annotated-cell-5-5" class="code-annotation-target"><a href="#annotated-cell-5-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">fct =</span> <span class="fu">LL.4</span>(</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="4">4</button><span id="annotated-cell-5-6" class="code-annotation-target"><a href="#annotated-cell-5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"slope"</span>, <span class="st">"Ymin"</span>, <span class="st">"Ymax"</span>, <span class="st">"EC50"</span>),</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="5">5</button><span id="annotated-cell-5-7" class="code-annotation-target"><a href="#annotated-cell-5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixed=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)</span>
<span id="annotated-cell-5-8"><a href="#annotated-cell-5-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="annotated-cell-5-9"><a href="#annotated-cell-5-9" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="annotated-cell-5-10"><a href="#annotated-cell-5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="annotated-cell-5-11"><a href="#annotated-cell-5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Modèle pour la reproduction</span></span>
<span id="annotated-cell-5-12"><a href="#annotated-cell-5-12" aria-hidden="true" tabindex="-1"></a>drc.repro <span class="ot">&lt;-</span> <span class="fu">drm</span>(</span>
<span id="annotated-cell-5-13"><a href="#annotated-cell-5-13" aria-hidden="true" tabindex="-1"></a>  Oeuf <span class="sc">~</span> Dose,                                  </span>
<span id="annotated-cell-5-14"><a href="#annotated-cell-5-14" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> df_sim_repro,</span>
<button class="code-annotation-anchor" data-target-cell="annotated-cell-5" data-target-annotation="6">6</button><span id="annotated-cell-5-15" class="code-annotation-target"><a href="#annotated-cell-5-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">type=</span><span class="st">"Poisson"</span>,</span>
<span id="annotated-cell-5-16"><a href="#annotated-cell-5-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">fct =</span> <span class="fu">LL.4</span>(                                   </span>
<span id="annotated-cell-5-17"><a href="#annotated-cell-5-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">names =</span> <span class="fu">c</span>(<span class="st">"slope"</span>, <span class="st">"Ymin"</span>, <span class="st">"Ymax"</span>, <span class="st">"EC50"</span>), </span>
<span id="annotated-cell-5-18"><a href="#annotated-cell-5-18" aria-hidden="true" tabindex="-1"></a>    <span class="at">fixed=</span><span class="fu">c</span>(<span class="cn">NA</span>, <span class="dv">0</span>, <span class="cn">NA</span>, <span class="cn">NA</span>)                      </span>
<span id="annotated-cell-5-19"><a href="#annotated-cell-5-19" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="annotated-cell-5-20"><a href="#annotated-cell-5-20" aria-hidden="true" tabindex="-1"></a>)</span><div class="code-annotation-gutter-bg"></div><div class="code-annotation-gutter"></div></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-annotation">
<dl class="code-annotation-container-hidden code-annotation-container-grid">
<dt data-target-cell="annotated-cell-5" data-target-annotation="1">1</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="3" data-code-annotation="1">Spécification de la formule : Endpoint à modéliser = Taux de croissance en fonction de la dose</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="2">2</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="4" data-code-annotation="2">Données à utiliser</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="3">3</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="5" data-code-annotation="3">Spécification du type de modèle à utiliser. Il existe différentes variante mais le modèle de Hill (modèle log-logistique à 4 paramètres) est le plus couramment utilisé</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="4">4</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="6" data-code-annotation="4">Re-définition du nom des variables du modèle pour qu’ils soient plus explicite</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="5">5</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="7" data-code-annotation="5">Argument permettant de fixer la valeur de certains paramètres du modèle. NA est mis quand on ne veut pas les fixer mais les estimer.</span>
</dd>
<dt data-target-cell="annotated-cell-5" data-target-annotation="6">6</dt>
<dd>
<span data-code-cell="annotated-cell-5" data-code-lines="15" data-code-annotation="6">On spécifie que les résidus suivent une loi de Poisson.</span>
</dd>
</dl>
</div>
</div>
<p>Résumé du modèle pour la croissance :</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(drc.croiss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Model fitted: Log-logistic (ED50 as parameter) (4 parms)

Parameter estimates:

                   Estimate Std. Error t-value p-value    
slope:(Intercept)   1.88746    0.73049  2.5838 0.01398 *  
Ymin:(Intercept)   -6.09085    5.62077 -1.0836 0.28573    
Ymax:(Intercept)   29.78746    1.93415 15.4008 &lt; 2e-16 ***
EC50:(Intercept)  111.42508   31.73265  3.5114 0.00122 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error:

 7.537188 (36 degrees of freedom)</code></pre>
</div>
</div>
<p>Résumé du modèle pour la reproduction :</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(drc.repro)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Model fitted: Log-logistic (ED50 as parameter) (3 parms)

Parameter estimates:

                  Estimate Std. Error t-value   p-value    
slope:(Intercept)  0.82278    0.10627  7.7424 9.764e-15 ***
Ymax:(Intercept)  19.58948    1.26778 15.4518 &lt; 2.2e-16 ***
EC50:(Intercept)  13.34481    3.62995  3.6763 0.0002366 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Nous pouvons également extraire des EC<span class="math inline">\(_{10}\)</span> des ces modèles :</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>EC10_croiss <span class="ot">&lt;-</span> <span class="fu">ED</span>(drc.croiss, <span class="dv">10</span>, <span class="at">interval =</span> <span class="st">"delta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Estimated effective doses

       Estimate Std. Error   Lower   Upper
e:1:10  34.7866    13.2517  7.9109 61.6623</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>EC10_repro <span class="ot">&lt;-</span> <span class="fu">ED</span>(drc.repro, <span class="dv">10</span>, <span class="at">interval =</span> <span class="st">"delta"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Estimated effective doses

        Estimate Std. Error     Lower     Upper
e:1:10  0.923696   0.502550 -0.061284  1.908677</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>EC10_croiss_show <span class="ot">&lt;-</span> <span class="fu">round</span>(EC10_croiss[<span class="dv">1</span>],<span class="dv">2</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>EC10_repro_show <span class="ot">&lt;-</span> <span class="fu">round</span>(EC10_repro[<span class="dv">1</span>],<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<ul>
<li>Croissance : EC<span class="math inline">\(_{10}\)</span> = 34.79 mg/L</li>
<li>Reproduction : EC<span class="math inline">\(_{10}\)</span> = 0.92 mg/L</li>
</ul>
</section>
<section id="etape-3---visualisation-des-résultats-du-modèle" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="etape-3---visualisation-des-résultats-du-modèle"><span class="header-section-number">3.3</span> Etape 3 - Visualisation des résultats du modèle</h2>
<p>Pour pouvoir tracer les résultats du modèle proprement avec <code>ggplot</code>, il faut faire quelque tour de passe-passe mais la fonction <code>plot(nom_du_modèle)</code> peut simplement être utilisée.</p>
<p>On définit une fonction de Hill pour chacun de nos endpoints. Puis, on créé des dataframes correspondant aux prédictions de la réponse de nos dragons pour un très grand nombre de doses.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>f_Hill_croiss <span class="ot">&lt;-</span> <span class="cf">function</span>(Dose){</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  slope <span class="ot">&lt;-</span> <span class="fu">coef</span>(drc.croiss)[<span class="dv">1</span>]</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  Y_min <span class="ot">&lt;-</span> <span class="fu">coef</span>(drc.croiss)[<span class="dv">2</span>]</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  Y_max <span class="ot">&lt;-</span> <span class="fu">coef</span>(drc.croiss)[<span class="dv">3</span>]</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  EC50 <span class="ot">&lt;-</span> <span class="fu">coef</span>(drc.croiss)[<span class="dv">4</span>]</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Y_min<span class="sc">+</span>(Y_max<span class="sc">-</span>Y_min)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(slope<span class="sc">*</span>(<span class="fu">log</span>(Dose)<span class="sc">-</span><span class="fu">log</span>(EC50)))))</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>f_Hill_repro <span class="ot">&lt;-</span> <span class="cf">function</span>(Dose){</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  slope <span class="ot">&lt;-</span> <span class="fu">coef</span>(drc.repro)[<span class="dv">1</span>]</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  Y_min <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  Y_max <span class="ot">&lt;-</span> <span class="fu">coef</span>(drc.repro)[<span class="dv">2</span>]</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>  EC50 <span class="ot">&lt;-</span> <span class="fu">coef</span>(drc.repro)[<span class="dv">3</span>]</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(Y_min<span class="sc">+</span>(Y_max<span class="sc">-</span>Y_min)<span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span><span class="fu">exp</span>(slope<span class="sc">*</span>(<span class="fu">log</span>(Dose)<span class="sc">-</span><span class="fu">log</span>(EC50)))))</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.01</span>, <span class="dv">5000</span>, <span class="fl">0.01</span>)</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>df_drc_croiss <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span>x,</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="at">y=</span><span class="fu">f_Hill_croiss</span>(x)</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>df_drc_repro <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span>x,</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">y=</span><span class="fu">f_Hill_repro</span>(x)</span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Il faut également qu’on puisse afficher les intervalles de confiance à 95% de notre modèle.</p>
<div class="cell">
<details open="" class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>Dose_x <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">exp</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">seq</span>(</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">log</span>(<span class="fl">0.01</span>),<span class="fu">log</span>(<span class="dv">5000</span>), </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>      <span class="at">by=</span>(<span class="fu">log</span>(<span class="dv">5000</span>)<span class="sc">-</span><span class="fu">log</span>(<span class="fl">0.01</span>))<span class="sc">/</span><span class="dv">100</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>CI.croiss <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">Dose=</span>Dose_x<span class="sc">$</span>Var1</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>pm.croiss <span class="ot">&lt;-</span> <span class="fu">predict</span>(drc.croiss, <span class="at">newdata=</span>CI.croiss, <span class="at">interval=</span><span class="st">"confidence"</span>)</span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>CI.croiss<span class="sc">$</span>p <span class="ot">&lt;-</span> pm.croiss[,<span class="dv">1</span>]</span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>CI.croiss<span class="sc">$</span>pmin <span class="ot">&lt;-</span> pm.croiss[,<span class="dv">2</span>]</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>CI.croiss<span class="sc">$</span>pmax <span class="ot">&lt;-</span> pm.croiss[,<span class="dv">3</span>]</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>CI.repro <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>  <span class="at">Dose=</span>Dose_x<span class="sc">$</span>Var1</span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>pm.repro <span class="ot">&lt;-</span> <span class="fu">predict</span>(drc.repro, <span class="at">newdata=</span>CI.repro, <span class="at">interval=</span><span class="st">"confidence"</span>)</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>CI.repro<span class="sc">$</span>p <span class="ot">&lt;-</span> pm.repro[,<span class="dv">1</span>]</span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>CI.repro<span class="sc">$</span>pmin <span class="ot">&lt;-</span> pm.repro[,<span class="dv">2</span>]</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>CI.repro<span class="sc">$</span>pmax <span class="ot">&lt;-</span> pm.repro[,<span class="dv">3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Grâce à tout cela on peut enfin tracer nos graphiques.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Paramètres des graphiques </span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>size_mean <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>alpha_rep <span class="ot">&lt;-</span> <span class="fl">0.5</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>alpha_ribbon <span class="ot">&lt;-</span> <span class="fl">0.2</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>line_width <span class="ot">&lt;-</span> <span class="fl">1.2</span> </span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>p_drc_C <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Affichage des intervalles de confiance à 95%</span></span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>CI.croiss, </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>Dose, </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span>p, </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin=</span>pmin, <span class="at">ymax=</span>pmax</span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span>alpha_ribbon,</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="co">#color = col_croiss,</span></span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> col_croiss</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Affichage de la courbe prédite par le modèle</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_drc_croiss, </span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>x, </span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span>y</span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> line_width,</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_croiss</span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># On réaffiche nos données de la même manière que précédement</span></span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>df_sim_croiss, </span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>Dose, </span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span>Txcroiss</span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span>alpha_rep,</span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_croiss</span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>df_sim_croiss_mean, </span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>Dose, </span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span>Txcroiss</span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span><span class="dv">1</span>,</span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> size_mean,</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_croiss</span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()<span class="sc">+</span></span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span><span class="st">"Dose en éther (mg/kg)"</span>,</span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>  <span class="at">y=</span><span class="st">"Taux de croissance des dragons (kg/jour)"</span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb14-60"><a href="#cb14-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-61"><a href="#cb14-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb14-62"><a href="#cb14-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-63"><a href="#cb14-63" aria-hidden="true" tabindex="-1"></a>p_drc_R <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb14-64"><a href="#cb14-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-65"><a href="#cb14-65" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Affichage des intervalles de confiance à 95%</span></span>
<span id="cb14-66"><a href="#cb14-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(</span>
<span id="cb14-67"><a href="#cb14-67" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>CI.repro, </span>
<span id="cb14-68"><a href="#cb14-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb14-69"><a href="#cb14-69" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>Dose, </span>
<span id="cb14-70"><a href="#cb14-70" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span>p, </span>
<span id="cb14-71"><a href="#cb14-71" aria-hidden="true" tabindex="-1"></a>      <span class="at">ymin=</span>pmin, <span class="at">ymax=</span>pmax</span>
<span id="cb14-72"><a href="#cb14-72" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb14-73"><a href="#cb14-73" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span>alpha_ribbon,</span>
<span id="cb14-74"><a href="#cb14-74" aria-hidden="true" tabindex="-1"></a>    <span class="co">#color = col_repro,</span></span>
<span id="cb14-75"><a href="#cb14-75" aria-hidden="true" tabindex="-1"></a>    <span class="at">fill =</span> col_repro</span>
<span id="cb14-76"><a href="#cb14-76" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb14-77"><a href="#cb14-77" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-78"><a href="#cb14-78" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Affichage de la courbe prédite par le modèle</span></span>
<span id="cb14-79"><a href="#cb14-79" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(</span>
<span id="cb14-80"><a href="#cb14-80" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_drc_repro, </span>
<span id="cb14-81"><a href="#cb14-81" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb14-82"><a href="#cb14-82" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>x, </span>
<span id="cb14-83"><a href="#cb14-83" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span>y</span>
<span id="cb14-84"><a href="#cb14-84" aria-hidden="true" tabindex="-1"></a>      ),</span>
<span id="cb14-85"><a href="#cb14-85" aria-hidden="true" tabindex="-1"></a>    <span class="at">linewidth =</span> line_width,</span>
<span id="cb14-86"><a href="#cb14-86" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_repro</span>
<span id="cb14-87"><a href="#cb14-87" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb14-88"><a href="#cb14-88" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-89"><a href="#cb14-89" aria-hidden="true" tabindex="-1"></a>  <span class="co"># On réaffiche nos données de la même manière que précédement</span></span>
<span id="cb14-90"><a href="#cb14-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb14-91"><a href="#cb14-91" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>df_sim_repro, </span>
<span id="cb14-92"><a href="#cb14-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb14-93"><a href="#cb14-93" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>Dose, </span>
<span id="cb14-94"><a href="#cb14-94" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span>Oeuf</span>
<span id="cb14-95"><a href="#cb14-95" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb14-96"><a href="#cb14-96" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span>alpha_rep,</span>
<span id="cb14-97"><a href="#cb14-97" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_repro</span>
<span id="cb14-98"><a href="#cb14-98" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb14-99"><a href="#cb14-99" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb14-100"><a href="#cb14-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">data=</span>df_sim_repro_mean, </span>
<span id="cb14-101"><a href="#cb14-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">aes</span>(</span>
<span id="cb14-102"><a href="#cb14-102" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span>Dose, </span>
<span id="cb14-103"><a href="#cb14-103" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span>Oeuf</span>
<span id="cb14-104"><a href="#cb14-104" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb14-105"><a href="#cb14-105" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span><span class="dv">1</span>,</span>
<span id="cb14-106"><a href="#cb14-106" aria-hidden="true" tabindex="-1"></a>    <span class="at">size =</span> size_mean,</span>
<span id="cb14-107"><a href="#cb14-107" aria-hidden="true" tabindex="-1"></a>    <span class="at">color =</span> col_repro</span>
<span id="cb14-108"><a href="#cb14-108" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb14-109"><a href="#cb14-109" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-110"><a href="#cb14-110" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()<span class="sc">+</span></span>
<span id="cb14-111"><a href="#cb14-111" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb14-112"><a href="#cb14-112" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb14-113"><a href="#cb14-113" aria-hidden="true" tabindex="-1"></a>  <span class="at">x=</span><span class="st">"Dose en éther (mg/kg)"</span>,</span>
<span id="cb14-114"><a href="#cb14-114" aria-hidden="true" tabindex="-1"></a>  <span class="at">y=</span><span class="st">"Nombre d'oeuf produits par les dragons (#)"</span></span>
<span id="cb14-115"><a href="#cb14-115" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb14-116"><a href="#cb14-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-117"><a href="#cb14-117" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb14-118"><a href="#cb14-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-119"><a href="#cb14-119" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> p_drc_C <span class="sc">+</span> p_drc_R <span class="sc">+</span>                              </span>
<span id="cb14-120"><a href="#cb14-120" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot_layout</span>(<span class="at">ncol =</span> <span class="dv">2</span>)                        </span>
<span id="cb14-121"><a href="#cb14-121" aria-hidden="true" tabindex="-1"></a>p</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-drcdragon" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-drcdragon-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="B_Courbe_dose_reponse_avec_R_files/figure-html/fig-drcdragon-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-drcdragon-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.3: Taux de croissance et production d’oeufs des dragons en fonction de la dose d’éther
</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="etape-4---validation-du-modèle" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="etape-4---validation-du-modèle"><span class="header-section-number">3.4</span> Etape 4 - Validation du modèle</h2>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>plot_QQ.croiss <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping=</span><span class="fu">aes</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample=</span><span class="fu">residuals</span>(drc.croiss)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span><span class="fl">0.3</span>,</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>col_croiss</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>(<span class="at">color=</span>col_croiss)<span class="sc">+</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="st">"Normal quantiles"</span>, </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span><span class="st">"Residuals"</span>,</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Croissance"</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>plot_resfit.croiss <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping=</span><span class="fu">aes</span>(</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span><span class="fu">fitted</span>(drc.croiss), </span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span><span class="fu">residuals</span>(drc.croiss)</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>col_croiss, </span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span><span class="fl">0.3</span></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="st">"Fitted"</span>, </span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span><span class="st">"Residuals"</span>,</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Croissance"</span></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()<span class="sc">+</span></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>plot_QQ.repro <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(</span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>  <span class="at">mapping=</span><span class="fu">aes</span>(</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">sample=</span><span class="fu">residuals</span>(drc.repro)</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>  )<span class="sc">+</span></span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq</span>(</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span><span class="fl">0.3</span>,</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>col_repro</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_qq_line</span>(<span class="at">color=</span>col_repro)<span class="sc">+</span></span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="st">"Normal quantiles"</span>, </span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span><span class="st">"Residuals"</span>,</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Reproduction"</span></span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a>plot_resfit.repro <span class="ot">&lt;-</span> <span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(</span>
<span id="cb15-54"><a href="#cb15-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">mapping=</span><span class="fu">aes</span>(</span>
<span id="cb15-55"><a href="#cb15-55" aria-hidden="true" tabindex="-1"></a>      <span class="at">x=</span><span class="fu">fitted</span>(drc.repro), </span>
<span id="cb15-56"><a href="#cb15-56" aria-hidden="true" tabindex="-1"></a>      <span class="at">y=</span><span class="fu">residuals</span>(drc.repro)</span>
<span id="cb15-57"><a href="#cb15-57" aria-hidden="true" tabindex="-1"></a>      ), </span>
<span id="cb15-58"><a href="#cb15-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">color=</span>col_repro, </span>
<span id="cb15-59"><a href="#cb15-59" aria-hidden="true" tabindex="-1"></a>    <span class="at">alpha=</span><span class="fl">0.3</span></span>
<span id="cb15-60"><a href="#cb15-60" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb15-61"><a href="#cb15-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(</span>
<span id="cb15-62"><a href="#cb15-62" aria-hidden="true" tabindex="-1"></a>    <span class="at">x=</span><span class="st">"Fitted"</span>, </span>
<span id="cb15-63"><a href="#cb15-63" aria-hidden="true" tabindex="-1"></a>    <span class="at">y=</span><span class="st">"Residuals"</span>,</span>
<span id="cb15-64"><a href="#cb15-64" aria-hidden="true" tabindex="-1"></a>    <span class="at">title =</span> <span class="st">"Reproduction"</span></span>
<span id="cb15-65"><a href="#cb15-65" aria-hidden="true" tabindex="-1"></a>    )<span class="sc">+</span></span>
<span id="cb15-66"><a href="#cb15-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_log10</span>()<span class="sc">+</span></span>
<span id="cb15-67"><a href="#cb15-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>()</span>
<span id="cb15-68"><a href="#cb15-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-69"><a href="#cb15-69" aria-hidden="true" tabindex="-1"></a>plot <span class="ot">&lt;-</span> plot_resfit.croiss <span class="sc">+</span> plot_QQ.croiss <span class="sc">+</span> plot_resfit.repro <span class="sc">+</span> plot_QQ.repro <span class="sc">+</span> <span class="fu">plot_layout</span>(<span class="at">ncol=</span><span class="dv">2</span>)</span>
<span id="cb15-70"><a href="#cb15-70" aria-hidden="true" tabindex="-1"></a>plot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-drcdiag" class="quarto-float quarto-figure quarto-figure-center anchored">
<figure class="quarto-float quarto-float-fig figure">
<div aria-describedby="fig-drcdiag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
<img src="B_Courbe_dose_reponse_avec_R_files/figure-html/fig-drcdiag-1.png" class="img-fluid figure-img" width="768">
</div>
<figcaption class="quarto-float-caption-bottom quarto-float-caption quarto-float-fig" id="fig-drcdiag-caption-0ceaefa1-69ba-4598-a22c-09a6ac19f8ca">
Figure&nbsp;3.4: Diagnostic graphs
</figcaption>
</figure>
</div>
</div>
</div>
<p>Test de la normalité des résidus :</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(drc.croiss))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(drc.croiss)
W = 0.96991, p-value = 0.3575</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(drc.repro))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  residuals(drc.repro)
W = 0.97294, p-value = 0.4437</code></pre>
</div>
</div>
<p>L’hypothèse nulle spécifie la normalité des résidus, alors que l’hypothèse alternative spécifie la non-normalité. La p-value étant &gt;0.05, rien ne permet de rejeter cette hypothèse de normalité.</p>
<p>Test de l’homogénéité des résidus :</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>(drc.croiss), </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>(df_sim_croiss<span class="sc">$</span>Dose)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  residuals(drc.croiss) and as.factor(df_sim_croiss$Dose)
Bartlett's K-squared = 5.6592, df = 7, p-value = 0.5801</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>(drc.repro), </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>(df_sim_repro<span class="sc">$</span>Dose)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  ) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  residuals(drc.repro) and as.factor(df_sim_repro$Dose)
Bartlett's K-squared = 13.409, df = 7, p-value = 0.06275</code></pre>
</div>
</div>
<p>L’hypothèse nulle spécifie l’homogénéité des résidus, alors que l’hypothèse alternative spécifie leur hétérogénéité. La p-value étant &gt;0.05, rien ne permet de rejeter cette hypothèse d’homogénéité des résidus.</p>
</section>
<section id="etape-5---détermination-de-la-noec-et-de-la-loec" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="etape-5---détermination-de-la-noec-et-de-la-loec"><span class="header-section-number">3.5</span> Etape 5 - Détermination de la NOEC et de la LOEC</h2>
<p>Pour déterminer la NOEC et la LOEC, il faut regarder si nos points expérimentaux sont significativement différents entre eux.</p>
<section id="pour-la-croissance" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="pour-la-croissance"><span class="header-section-number">3.5.1</span> Pour la croissance</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(df_sim_croiss<span class="sc">$</span>Txcroiss)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  df_sim_croiss$Txcroiss
W = 0.96064, p-value = 0.1761</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  Txcroiss<span class="sc">~</span>Dose_f,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>df_sim_croiss</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  Txcroiss by Dose_f
Bartlett's K-squared = 5.6592, df = 7, p-value = 0.5801</code></pre>
</div>
</div>
<p>L’hypothèse de normalité des données et d’homogénéité des variances sont vérifiées.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>lm.croiss <span class="ot">&lt;-</span> <span class="fu">aov</span>(Txcroiss <span class="sc">~</span> Dose_f, <span class="at">data =</span> df_sim_croiss)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.croiss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Dose_f       7   7028  1004.0   19.05 9.36e-10 ***
Residuals   32   1687    52.7                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>dunnett.test.croiss <span class="ot">&lt;-</span> <span class="fu">glht</span>(lm.croiss, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">Dose_f =</span> <span class="st">"Dunnett"</span>))</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dunnett.test.croiss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Dunnett Contrasts


Fit: aov(formula = Txcroiss ~ Dose_f, data = df_sim_croiss)

Linear Hypotheses:
                          Estimate Std. Error t value Pr(&gt;|t|)    
5 - 0 == 0                  -8.651      4.592  -1.884  0.29015    
10.7721734501594 - 0 == 0    2.082      4.592   0.453  0.99741    
23.2079441680639 - 0 == 0   -2.022      4.592  -0.440  0.99784    
50 - 0 == 0                 -9.387      4.592  -2.044  0.21911    
107.721734501594 - 0 == 0  -19.271      4.592  -4.197  0.00126 ** 
232.079441680639 - 0 == 0  -29.818      4.592  -6.494  &lt; 0.001 ***
500 - 0 == 0               -36.122      4.592  -7.866  &lt; 0.001 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
</div>
<p>D’après ces résultats, on en déduit que pour notre jeu de données :</p>
<ul>
<li>NOEC = 50 mg/L</li>
<li>LOEC = 107.7 mg/L</li>
</ul>
</section>
<section id="pour-la-reproduction" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="pour-la-reproduction"><span class="header-section-number">3.5.2</span> Pour la reproduction</h3>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(df_sim_repro<span class="sc">$</span>Oeuf)  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Shapiro-Wilk normality test

data:  df_sim_repro$Oeuf
W = 0.95112, p-value = 0.08287</code></pre>
</div>
</div>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  Oeuf<span class="sc">~</span>Dose_f,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>df_sim_repro</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Bartlett test of homogeneity of variances

data:  Oeuf by Dose_f
Bartlett's K-squared = 13.409, df = 7, p-value = 0.06275</code></pre>
</div>
</div>
<p>L’hypothèse de normalité des données et d’homogénéité des variances sont vérifiées.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>lm.repro <span class="ot">&lt;-</span> <span class="fu">aov</span>(Oeuf <span class="sc">~</span> Dose_f, <span class="at">data =</span> df_sim_repro)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm.repro)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>            Df Sum Sq Mean Sq F value   Pr(&gt;F)    
Dose_f       7 1937.4   276.8   17.52 2.63e-09 ***
Residuals   32  505.6    15.8                     
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>dunnett.test.repro <span class="ot">&lt;-</span> <span class="fu">glht</span>(lm.repro, <span class="at">linfct =</span> <span class="fu">mcp</span>(<span class="at">Dose_f =</span> <span class="st">"Dunnett"</span>))</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(dunnett.test.repro)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Multiple Comparisons of Means: Dunnett Contrasts


Fit: aov(formula = Oeuf ~ Dose_f, data = df_sim_repro)

Linear Hypotheses:
                           Estimate Std. Error t value Pr(&gt;|t|)    
0.25 - 0 == 0                -1.120      2.514  -0.445    0.998    
0.790569415042095 - 0 == 0    0.760      2.514   0.302    1.000    
2.5 - 0 == 0                  1.260      2.514   0.501    0.995    
7.90569415042095 - 0 == 0    -5.800      2.514  -2.307    0.133    
25 - 0 == 0                 -11.440      2.514  -4.550   &lt;0.001 ***
79.0569415042095 - 0 == 0   -17.520      2.514  -6.969   &lt;0.001 ***
250 - 0 == 0                -14.180      2.514  -5.640   &lt;0.001 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- single-step method)</code></pre>
</div>
</div>
<p>D’après ces résultats, on en déduit que pour notre jeu de données :</p>
<ul>
<li>NOEC = 7.9 mg/L</li>
<li>LOEC = 25 mg/L</li>
</ul>
<p>Si une des hypothèses n’était pas vérifiée, on ferait :</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(Oeuf <span class="sc">~</span> Dose_f, <span class="at">data =</span> df_sim_repro)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    Kruskal-Wallis rank sum test

data:  Oeuf by Dose_f
Kruskal-Wallis chi-squared = 30.529, df = 7, p-value = 7.592e-05</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>dunn.repro <span class="ot">&lt;-</span> <span class="fu">dunnTest</span>(Oeuf <span class="sc">~</span> Dose_f, <span class="at">data =</span> df_sim_repro, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>dunn_results <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dunn.repro<span class="sc">$</span>res) </span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>dunn_results <span class="sc">|&gt;</span> </span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Comparison, P.adj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                             Comparison       P.adj
1                              0 - 0.25 1.000000000
2                 0 - 0.790569415042095 1.000000000
3              0.25 - 0.790569415042095 1.000000000
4                               0 - 2.5 1.000000000
5                            0.25 - 2.5 1.000000000
6               0.790569415042095 - 2.5 1.000000000
7                                0 - 25 0.578731836
8                             0.25 - 25 1.000000000
9                0.790569415042095 - 25 0.400778928
10                             2.5 - 25 0.331444950
11                              0 - 250 0.125636139
12                           0.25 - 250 0.272963926
13              0.790569415042095 - 250 0.081491244
14                            2.5 - 250 0.065214131
15                             25 - 250 1.000000000
16                 0 - 7.90569415042095 1.000000000
17              0.25 - 7.90569415042095 1.000000000
18 0.790569415042095 - 7.90569415042095 1.000000000
19               2.5 - 7.90569415042095 1.000000000
20                25 - 7.90569415042095 1.000000000
21               250 - 7.90569415042095 1.000000000
22                 0 - 79.0569415042095 0.013460784
23              0.25 - 79.0569415042095 0.034160935
24 0.790569415042095 - 79.0569415042095 0.008041486
25               2.5 - 79.0569415042095 0.006175182
26                25 - 79.0569415042095 1.000000000
27               250 - 79.0569415042095 1.000000000
28  7.90569415042095 - 79.0569415042095 0.578731836</code></pre>
</div>
</div>
<p>Ce test statistique nous permet pas de déterminer une NOEC et une LOEC. Cela est du à la plus faible puissance statistique d’un test non-paramétrique vs.&nbsp;paramétrique comme utilisé juste avant.</p>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      const annoteTargets = window.document.querySelectorAll('.code-annotation-anchor');
      for (let i=0; i<annoteTargets.length; i++) {
        const annoteTarget = annoteTargets[i];
        const targetCell = annoteTarget.getAttribute("data-target-cell");
        const targetAnnotation = annoteTarget.getAttribute("data-target-annotation");
        const contentFn = () => {
          const content = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          if (content) {
            const tipContent = content.cloneNode(true);
            tipContent.classList.add("code-annotation-tip-content");
            return tipContent.outerHTML;
          }
        }
        const config = {
          allowHTML: true,
          content: contentFn,
          onShow: (instance) => {
            selectCodeLines(instance.reference);
            instance.reference.classList.add('code-annotation-active');
            window.tippy.hideAll();
          },
          onHide: (instance) => {
            unselectCodeLines();
            instance.reference.classList.remove('code-annotation-active');
          },
          maxWidth: 300,
          delay: [50, 0],
          duration: [200, 0],
          offset: [5, 10],
          arrow: true,
          trigger: 'click',
          appendTo: function(el) {
            return el.parentElement.parentElement.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'quarto',
          placement: 'right',
          positionFixed: true,
          popperOptions: {
            modifiers: [
            {
              name: 'flip',
              options: {
                flipVariations: false, // true by default
                allowedAutoPlacements: ['right'],
                fallbackPlacements: ['right', 'top', 'top-start', 'top-end', 'bottom', 'bottom-start', 'bottom-end', 'left'],
              },
            },
            {
              name: 'preventOverflow',
              options: {
                mainAxis: false,
                altAxis: false
              }
            }
            ]        
          }      
        };
        window.tippy(annoteTarget, config); 
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../quarto/A_Theorie_courbe_dose_reponse.html" class="pagination-link" aria-label="Principe des courbes dose-réponse">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Principe des courbes dose-réponse</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb44" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Modélisation de la courbe dose-réponse - Exemple</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, include=F}</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse); library(drc); library(readxl); library(nord)</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="in">library(patchwork); library(multcomp); library(FSA)</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="in">Nord_frost &lt;- nord(palette = "frost")</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="in">Nord_aurora &lt;- nord(palette = "aurora")</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="in">Nord_polar &lt;- nord(palette = "polarnight")</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="in">Nord_snow &lt;- nord(palette = "snowstorm")</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="in">col_croiss &lt;- Nord_frost[2]</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="in">col_repro &lt;- Nord_frost[4]</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=F}</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: show</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="in">library(tidyverse); library(drc); library(readxl); library(nord) # &lt;1&gt; </span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="in">Nord_frost &lt;- nord(palette = "frost")                            # &lt;2&gt; </span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="in">Nord_aurora &lt;- nord(palette = "aurora")                          # &lt;2&gt; </span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="in">Nord_polar &lt;- nord(palette = "polarnight")                       # &lt;2&gt; </span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="in">Nord_snow &lt;- nord(palette = "snowstorm")                         # &lt;2&gt; </span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a><span class="in">col_croiss &lt;- Nord_frost[2]                                      # &lt;3&gt;</span></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a><span class="in">col_repro &lt;- Nord_frost[4]                                       # &lt;3&gt;</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-29"><a href="#cb44-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-30"><a href="#cb44-30" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Packages utilisés ici</span>
<span id="cb44-31"><a href="#cb44-31" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Palettes de couleurs sympa qui vient d'ici : https://www.nordtheme.com</span>
<span id="cb44-32"><a href="#cb44-32" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Définition des couleurs pour nos endpoints</span>
<span id="cb44-33"><a href="#cb44-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-34"><a href="#cb44-34" aria-hidden="true" tabindex="-1"></a>On s'intéresse à l'impact de la concentration en éther dans l'air (mg/L) sur la croissance et la reproduction des dragons. </span>
<span id="cb44-35"><a href="#cb44-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-36"><a href="#cb44-36" aria-hidden="true" tabindex="-1"></a><span class="fu">## Etape 1 - Importer et visualiser ses données</span></span>
<span id="cb44-37"><a href="#cb44-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-38"><a href="#cb44-38" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb44-39"><a href="#cb44-39" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: show</span></span>
<span id="cb44-40"><a href="#cb44-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-41"><a href="#cb44-41" aria-hidden="true" tabindex="-1"></a><span class="in">df_sim_croiss &lt;- read_excel(here::here("data/Data_sim_croiss_dragon.xlsx")) |&gt;  # &lt;1&gt;</span></span>
<span id="cb44-42"><a href="#cb44-42" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Dose_f = as.factor(Dose)) # &lt;3&gt;</span></span>
<span id="cb44-43"><a href="#cb44-43" aria-hidden="true" tabindex="-1"></a><span class="in">df_sim_repro &lt;- read_excel(here::here("data/Data_sim_repro_dragon.xlsx")) |&gt;    # &lt;2&gt;</span></span>
<span id="cb44-44"><a href="#cb44-44" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(Dose_f = as.factor(Dose)) # &lt;4&gt;</span></span>
<span id="cb44-45"><a href="#cb44-45" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-46"><a href="#cb44-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-47"><a href="#cb44-47" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Importation des données de croissance de nos dragons</span>
<span id="cb44-48"><a href="#cb44-48" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Importation des données de reproduction de nos dragons</span>
<span id="cb44-49"><a href="#cb44-49" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Creation de <span class="in">`Dose_f`</span>, de type factor</span>
<span id="cb44-50"><a href="#cb44-50" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Creation de <span class="in">`Dose_f`</span>, de type factor</span>
<span id="cb44-51"><a href="#cb44-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-52"><a href="#cb44-52" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb44-53"><a href="#cb44-53" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: show</span></span>
<span id="cb44-54"><a href="#cb44-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-55"><a href="#cb44-55" aria-hidden="true" tabindex="-1"></a><span class="in">head(df_sim_croiss) # &lt;1&gt;</span></span>
<span id="cb44-56"><a href="#cb44-56" aria-hidden="true" tabindex="-1"></a><span class="in">head(df_sim_repro)  # &lt;1&gt;</span></span>
<span id="cb44-57"><a href="#cb44-57" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-58"><a href="#cb44-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-59"><a href="#cb44-59" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Affiche les 5 premières lignes</span>
<span id="cb44-60"><a href="#cb44-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-61"><a href="#cb44-61" aria-hidden="true" tabindex="-1"></a>On a des jeux de données avec :</span>
<span id="cb44-62"><a href="#cb44-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-63"><a href="#cb44-63" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`ID`</span> : Numéro unique du dragon</span>
<span id="cb44-64"><a href="#cb44-64" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Nb_rep`</span> : Numéro de réplicat par rapport à un dose donnée</span>
<span id="cb44-65"><a href="#cb44-65" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Dose`</span> : Dose d'exposition du dragon (mg/L)</span>
<span id="cb44-66"><a href="#cb44-66" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Oeuf`</span> : Le nombre d'oeuf produit par le dragon en 1 an</span>
<span id="cb44-67"><a href="#cb44-67" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`Txcroiss`</span> : Le taux de croissance du dragon (kg/jour)</span>
<span id="cb44-68"><a href="#cb44-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-69"><a href="#cb44-69" aria-hidden="true" tabindex="-1"></a>Il serait bien de d'avoir des jeux de donnée avec la moyenne du taux de croissance et la moyenne du nombre d'oeuf produit par dose testée. </span>
<span id="cb44-70"><a href="#cb44-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-71"><a href="#cb44-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb44-72"><a href="#cb44-72" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: show</span></span>
<span id="cb44-73"><a href="#cb44-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-74"><a href="#cb44-74" aria-hidden="true" tabindex="-1"></a><span class="in">df_sim_croiss_mean &lt;- df_sim_croiss |&gt;   # &lt;1&gt;</span></span>
<span id="cb44-75"><a href="#cb44-75" aria-hidden="true" tabindex="-1"></a><span class="in">  aggregate(Txcroiss ~ Dose, FUN = mean) # &lt;1&gt;</span></span>
<span id="cb44-76"><a href="#cb44-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-77"><a href="#cb44-77" aria-hidden="true" tabindex="-1"></a><span class="in">df_sim_repro_mean &lt;- df_sim_repro |&gt;    # &lt;1&gt;</span></span>
<span id="cb44-78"><a href="#cb44-78" aria-hidden="true" tabindex="-1"></a><span class="in">  aggregate(Oeuf ~ Dose, FUN = mean) # &lt;1&gt;</span></span>
<span id="cb44-79"><a href="#cb44-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-80"><a href="#cb44-80" aria-hidden="true" tabindex="-1"></a><span class="in">head(df_sim_croiss_mean)</span></span>
<span id="cb44-81"><a href="#cb44-81" aria-hidden="true" tabindex="-1"></a><span class="in">head(df_sim_repro_mean)</span></span>
<span id="cb44-82"><a href="#cb44-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-83"><a href="#cb44-83" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-84"><a href="#cb44-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-85"><a href="#cb44-85" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Creation de nouveaux dataframes avec le taux de croissance et le nombre d'oeufs produits moyen par dose.</span>
<span id="cb44-86"><a href="#cb44-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-87"><a href="#cb44-87" aria-hidden="true" tabindex="-1"></a>Maintenant qu'on a importé nos données, on peut les visualiser de différentes façons.</span>
<span id="cb44-88"><a href="#cb44-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-89"><a href="#cb44-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-90"><a href="#cb44-90" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb44-91"><a href="#cb44-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-92"><a href="#cb44-92" aria-hidden="true" tabindex="-1"></a><span class="fu">## Dots</span></span>
<span id="cb44-93"><a href="#cb44-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-94"><a href="#cb44-94" aria-hidden="true" tabindex="-1"></a>On peut faire un graphique avec deux types de points : Les points correspondant aux réplicats et les points correspondant à la moyenne pour une dose donnée (@fig-datapoint). </span>
<span id="cb44-95"><a href="#cb44-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-96"><a href="#cb44-96" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb44-97"><a href="#cb44-97" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Taux de croissance et production d'oeufs des dragons en fonction de la dose d'éther</span></span>
<span id="cb44-98"><a href="#cb44-98" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-datapoint</span></span>
<span id="cb44-99"><a href="#cb44-99" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 8</span></span>
<span id="cb44-100"><a href="#cb44-100" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 4</span></span>
<span id="cb44-101"><a href="#cb44-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-102"><a href="#cb44-102" aria-hidden="true" tabindex="-1"></a><span class="in"># Paramètres des graphiques </span></span>
<span id="cb44-103"><a href="#cb44-103" aria-hidden="true" tabindex="-1"></a><span class="in">size_mean &lt;- 3</span></span>
<span id="cb44-104"><a href="#cb44-104" aria-hidden="true" tabindex="-1"></a><span class="in">alpha_rep &lt;- 0.5</span></span>
<span id="cb44-105"><a href="#cb44-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-106"><a href="#cb44-106" aria-hidden="true" tabindex="-1"></a><span class="in">p_C &lt;- ggplot()+                                  # &lt;1&gt;</span></span>
<span id="cb44-107"><a href="#cb44-107" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-108"><a href="#cb44-108" aria-hidden="true" tabindex="-1"></a><span class="in">  # Nuage de points avec un point par réplicat</span></span>
<span id="cb44-109"><a href="#cb44-109" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(</span></span>
<span id="cb44-110"><a href="#cb44-110" aria-hidden="true" tabindex="-1"></a><span class="in">      data = df_sim_croiss,                       # &lt;2&gt;</span></span>
<span id="cb44-111"><a href="#cb44-111" aria-hidden="true" tabindex="-1"></a><span class="in">      mapping = aes(                              # &lt;3&gt;</span></span>
<span id="cb44-112"><a href="#cb44-112" aria-hidden="true" tabindex="-1"></a><span class="in">        x = Dose,                                 # &lt;3&gt;</span></span>
<span id="cb44-113"><a href="#cb44-113" aria-hidden="true" tabindex="-1"></a><span class="in">        y = Txcroiss                              # &lt;3&gt;</span></span>
<span id="cb44-114"><a href="#cb44-114" aria-hidden="true" tabindex="-1"></a><span class="in">      ),                                          # &lt;3&gt;</span></span>
<span id="cb44-115"><a href="#cb44-115" aria-hidden="true" tabindex="-1"></a><span class="in">      alpha = alpha_rep,                          # &lt;4&gt;</span></span>
<span id="cb44-116"><a href="#cb44-116" aria-hidden="true" tabindex="-1"></a><span class="in">      color = col_croiss                          # &lt;5&gt;</span></span>
<span id="cb44-117"><a href="#cb44-117" aria-hidden="true" tabindex="-1"></a><span class="in">      )+</span></span>
<span id="cb44-118"><a href="#cb44-118" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-119"><a href="#cb44-119" aria-hidden="true" tabindex="-1"></a><span class="in">  # Nuage de points correspondant aux moyennes par dose</span></span>
<span id="cb44-120"><a href="#cb44-120" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(</span></span>
<span id="cb44-121"><a href="#cb44-121" aria-hidden="true" tabindex="-1"></a><span class="in">      data = df_sim_croiss_mean,</span></span>
<span id="cb44-122"><a href="#cb44-122" aria-hidden="true" tabindex="-1"></a><span class="in">      mapping = aes(</span></span>
<span id="cb44-123"><a href="#cb44-123" aria-hidden="true" tabindex="-1"></a><span class="in">        x = Dose,</span></span>
<span id="cb44-124"><a href="#cb44-124" aria-hidden="true" tabindex="-1"></a><span class="in">        y = Txcroiss</span></span>
<span id="cb44-125"><a href="#cb44-125" aria-hidden="true" tabindex="-1"></a><span class="in">      ),</span></span>
<span id="cb44-126"><a href="#cb44-126" aria-hidden="true" tabindex="-1"></a><span class="in">      alpha = 1,</span></span>
<span id="cb44-127"><a href="#cb44-127" aria-hidden="true" tabindex="-1"></a><span class="in">      color = col_croiss,</span></span>
<span id="cb44-128"><a href="#cb44-128" aria-hidden="true" tabindex="-1"></a><span class="in">      size = size_mean                            # &lt;6&gt;</span></span>
<span id="cb44-129"><a href="#cb44-129" aria-hidden="true" tabindex="-1"></a><span class="in">      )+</span></span>
<span id="cb44-130"><a href="#cb44-130" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-131"><a href="#cb44-131" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_log10()+                                # &lt;7&gt;</span></span>
<span id="cb44-132"><a href="#cb44-132" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-133"><a href="#cb44-133" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(                                           # &lt;8&gt;</span></span>
<span id="cb44-134"><a href="#cb44-134" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Dose en éther (mg/L)",                   # &lt;8&gt;</span></span>
<span id="cb44-135"><a href="#cb44-135" aria-hidden="true" tabindex="-1"></a><span class="in">    y = "Taux de croissance des dragons (kg/jour)"# &lt;8&gt;</span></span>
<span id="cb44-136"><a href="#cb44-136" aria-hidden="true" tabindex="-1"></a><span class="in">  )+                                              # &lt;8&gt;</span></span>
<span id="cb44-137"><a href="#cb44-137" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()                                 # &lt;9&gt;</span></span>
<span id="cb44-138"><a href="#cb44-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-139"><a href="#cb44-139" aria-hidden="true" tabindex="-1"></a><span class="in">p_R &lt;- ggplot()+ </span></span>
<span id="cb44-140"><a href="#cb44-140" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-141"><a href="#cb44-141" aria-hidden="true" tabindex="-1"></a><span class="in">  # Nuage de points avec un point par réplicat</span></span>
<span id="cb44-142"><a href="#cb44-142" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(</span></span>
<span id="cb44-143"><a href="#cb44-143" aria-hidden="true" tabindex="-1"></a><span class="in">      data = df_sim_repro, </span></span>
<span id="cb44-144"><a href="#cb44-144" aria-hidden="true" tabindex="-1"></a><span class="in">      mapping = aes( </span></span>
<span id="cb44-145"><a href="#cb44-145" aria-hidden="true" tabindex="-1"></a><span class="in">        x = Dose, </span></span>
<span id="cb44-146"><a href="#cb44-146" aria-hidden="true" tabindex="-1"></a><span class="in">        y = Oeuf </span></span>
<span id="cb44-147"><a href="#cb44-147" aria-hidden="true" tabindex="-1"></a><span class="in">      ), </span></span>
<span id="cb44-148"><a href="#cb44-148" aria-hidden="true" tabindex="-1"></a><span class="in">      alpha = alpha_rep, </span></span>
<span id="cb44-149"><a href="#cb44-149" aria-hidden="true" tabindex="-1"></a><span class="in">      color = col_repro</span></span>
<span id="cb44-150"><a href="#cb44-150" aria-hidden="true" tabindex="-1"></a><span class="in">      )+</span></span>
<span id="cb44-151"><a href="#cb44-151" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-152"><a href="#cb44-152" aria-hidden="true" tabindex="-1"></a><span class="in">  # Nuage de points correspondant aux moyennes par dose</span></span>
<span id="cb44-153"><a href="#cb44-153" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(</span></span>
<span id="cb44-154"><a href="#cb44-154" aria-hidden="true" tabindex="-1"></a><span class="in">      data = df_sim_repro_mean,</span></span>
<span id="cb44-155"><a href="#cb44-155" aria-hidden="true" tabindex="-1"></a><span class="in">      mapping = aes(</span></span>
<span id="cb44-156"><a href="#cb44-156" aria-hidden="true" tabindex="-1"></a><span class="in">        x = Dose,</span></span>
<span id="cb44-157"><a href="#cb44-157" aria-hidden="true" tabindex="-1"></a><span class="in">        y = Oeuf</span></span>
<span id="cb44-158"><a href="#cb44-158" aria-hidden="true" tabindex="-1"></a><span class="in">      ),</span></span>
<span id="cb44-159"><a href="#cb44-159" aria-hidden="true" tabindex="-1"></a><span class="in">      alpha = 1,</span></span>
<span id="cb44-160"><a href="#cb44-160" aria-hidden="true" tabindex="-1"></a><span class="in">      color = col_repro,</span></span>
<span id="cb44-161"><a href="#cb44-161" aria-hidden="true" tabindex="-1"></a><span class="in">      size = size_mean</span></span>
<span id="cb44-162"><a href="#cb44-162" aria-hidden="true" tabindex="-1"></a><span class="in">      )+</span></span>
<span id="cb44-163"><a href="#cb44-163" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-164"><a href="#cb44-164" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_log10()+</span></span>
<span id="cb44-165"><a href="#cb44-165" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-166"><a href="#cb44-166" aria-hidden="true" tabindex="-1"></a><span class="in">  labs( </span></span>
<span id="cb44-167"><a href="#cb44-167" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Dose en éther (mg/L)",</span></span>
<span id="cb44-168"><a href="#cb44-168" aria-hidden="true" tabindex="-1"></a><span class="in">    y = "Nombre d'oeufs produits par les dragons (#)"</span></span>
<span id="cb44-169"><a href="#cb44-169" aria-hidden="true" tabindex="-1"></a><span class="in">  )+</span></span>
<span id="cb44-170"><a href="#cb44-170" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()</span></span>
<span id="cb44-171"><a href="#cb44-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-172"><a href="#cb44-172" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- p_C + p_R +                                  # &lt;10&gt;</span></span>
<span id="cb44-173"><a href="#cb44-173" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(ncol = 2)                           # &lt;10&gt;</span></span>
<span id="cb44-174"><a href="#cb44-174" aria-hidden="true" tabindex="-1"></a><span class="in">p </span></span>
<span id="cb44-175"><a href="#cb44-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-176"><a href="#cb44-176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-177"><a href="#cb44-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-178"><a href="#cb44-178" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Initialisation du graphique</span>
<span id="cb44-179"><a href="#cb44-179" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Données utilisées pour ce nuage de points</span>
<span id="cb44-180"><a href="#cb44-180" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Axes à utiliser pour ce nuage de points</span>
<span id="cb44-181"><a href="#cb44-181" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Transparence des points</span>
<span id="cb44-182"><a href="#cb44-182" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Couleur des points</span>
<span id="cb44-183"><a href="#cb44-183" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>Taille des points pour ce nuage de points</span>
<span id="cb44-184"><a href="#cb44-184" aria-hidden="true" tabindex="-1"></a><span class="ss">7. </span>Axe des x mis en échelle log (logarithme base 10)</span>
<span id="cb44-185"><a href="#cb44-185" aria-hidden="true" tabindex="-1"></a><span class="ss">8. </span>Titres des axes</span>
<span id="cb44-186"><a href="#cb44-186" aria-hidden="true" tabindex="-1"></a><span class="ss">9. </span>Aspect général du graphique</span>
<span id="cb44-187"><a href="#cb44-187" aria-hidden="true" tabindex="-1"></a><span class="ss">10. </span>Les deux graphiques sont mis côte à côte</span>
<span id="cb44-188"><a href="#cb44-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-189"><a href="#cb44-189" aria-hidden="true" tabindex="-1"></a><span class="fu">## Boxplot</span></span>
<span id="cb44-190"><a href="#cb44-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-191"><a href="#cb44-191" aria-hidden="true" tabindex="-1"></a>Ou on peut faire des bowplots, où la dose est bien une catégorie et non un nombre (@fig-databox).  </span>
<span id="cb44-192"><a href="#cb44-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-193"><a href="#cb44-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE, warning=FALSE}</span></span>
<span id="cb44-194"><a href="#cb44-194" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Taux de croissance et production d'oeufs des dragons en fonction de la dose d'éther</span></span>
<span id="cb44-195"><a href="#cb44-195" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-databox</span></span>
<span id="cb44-196"><a href="#cb44-196" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 8</span></span>
<span id="cb44-197"><a href="#cb44-197" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 4</span></span>
<span id="cb44-198"><a href="#cb44-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-199"><a href="#cb44-199" aria-hidden="true" tabindex="-1"></a><span class="in"># Paramètres des graphiques </span></span>
<span id="cb44-200"><a href="#cb44-200" aria-hidden="true" tabindex="-1"></a><span class="in">alpha_box &lt;- 0.2</span></span>
<span id="cb44-201"><a href="#cb44-201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-202"><a href="#cb44-202" aria-hidden="true" tabindex="-1"></a><span class="in">p_C &lt;- ggplot(</span></span>
<span id="cb44-203"><a href="#cb44-203" aria-hidden="true" tabindex="-1"></a><span class="in">      data = df_sim_croiss,                    </span></span>
<span id="cb44-204"><a href="#cb44-204" aria-hidden="true" tabindex="-1"></a><span class="in">      mapping = aes(                          </span></span>
<span id="cb44-205"><a href="#cb44-205" aria-hidden="true" tabindex="-1"></a><span class="in">        x = as.factor(round(Dose,1)),      # &lt;1&gt;                         </span></span>
<span id="cb44-206"><a href="#cb44-206" aria-hidden="true" tabindex="-1"></a><span class="in">        y = Txcroiss                           </span></span>
<span id="cb44-207"><a href="#cb44-207" aria-hidden="true" tabindex="-1"></a><span class="in">      )</span></span>
<span id="cb44-208"><a href="#cb44-208" aria-hidden="true" tabindex="-1"></a><span class="in">  )+                                 </span></span>
<span id="cb44-209"><a href="#cb44-209" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-210"><a href="#cb44-210" aria-hidden="true" tabindex="-1"></a><span class="in">  # Boxplot</span></span>
<span id="cb44-211"><a href="#cb44-211" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot( </span></span>
<span id="cb44-212"><a href="#cb44-212" aria-hidden="true" tabindex="-1"></a><span class="in">      alpha = alpha_box,                          </span></span>
<span id="cb44-213"><a href="#cb44-213" aria-hidden="true" tabindex="-1"></a><span class="in">      color = col_croiss,                          </span></span>
<span id="cb44-214"><a href="#cb44-214" aria-hidden="true" tabindex="-1"></a><span class="in">      fill = col_croiss</span></span>
<span id="cb44-215"><a href="#cb44-215" aria-hidden="true" tabindex="-1"></a><span class="in">      )+</span></span>
<span id="cb44-216"><a href="#cb44-216" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-217"><a href="#cb44-217" aria-hidden="true" tabindex="-1"></a><span class="in">  # Points</span></span>
<span id="cb44-218"><a href="#cb44-218" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_dotplot(</span></span>
<span id="cb44-219"><a href="#cb44-219" aria-hidden="true" tabindex="-1"></a><span class="in">    binaxis='y', </span></span>
<span id="cb44-220"><a href="#cb44-220" aria-hidden="true" tabindex="-1"></a><span class="in">    stackdir='center', # &lt;2&gt;</span></span>
<span id="cb44-221"><a href="#cb44-221" aria-hidden="true" tabindex="-1"></a><span class="in">    dotsize=0.7, </span></span>
<span id="cb44-222"><a href="#cb44-222" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=0.9,                          </span></span>
<span id="cb44-223"><a href="#cb44-223" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_croiss,</span></span>
<span id="cb44-224"><a href="#cb44-224" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = col_croiss</span></span>
<span id="cb44-225"><a href="#cb44-225" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb44-226"><a href="#cb44-226" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-227"><a href="#cb44-227" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(                                         </span></span>
<span id="cb44-228"><a href="#cb44-228" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Dose en éther (mg/L)",              </span></span>
<span id="cb44-229"><a href="#cb44-229" aria-hidden="true" tabindex="-1"></a><span class="in">    y = "Taux de croissance des dragons (kg/jour)"</span></span>
<span id="cb44-230"><a href="#cb44-230" aria-hidden="true" tabindex="-1"></a><span class="in">  )+                                             </span></span>
<span id="cb44-231"><a href="#cb44-231" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() </span></span>
<span id="cb44-232"><a href="#cb44-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-233"><a href="#cb44-233" aria-hidden="true" tabindex="-1"></a><span class="in">p_R &lt;- ggplot(</span></span>
<span id="cb44-234"><a href="#cb44-234" aria-hidden="true" tabindex="-1"></a><span class="in">      data = df_sim_repro,                    </span></span>
<span id="cb44-235"><a href="#cb44-235" aria-hidden="true" tabindex="-1"></a><span class="in">      mapping = aes(                          </span></span>
<span id="cb44-236"><a href="#cb44-236" aria-hidden="true" tabindex="-1"></a><span class="in">        x = as.factor(round(Dose,1)),                               </span></span>
<span id="cb44-237"><a href="#cb44-237" aria-hidden="true" tabindex="-1"></a><span class="in">        y = Oeuf                           </span></span>
<span id="cb44-238"><a href="#cb44-238" aria-hidden="true" tabindex="-1"></a><span class="in">      )</span></span>
<span id="cb44-239"><a href="#cb44-239" aria-hidden="true" tabindex="-1"></a><span class="in">  )+                              </span></span>
<span id="cb44-240"><a href="#cb44-240" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-241"><a href="#cb44-241" aria-hidden="true" tabindex="-1"></a><span class="in">  # Boxplot</span></span>
<span id="cb44-242"><a href="#cb44-242" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_boxplot(</span></span>
<span id="cb44-243"><a href="#cb44-243" aria-hidden="true" tabindex="-1"></a><span class="in">      alpha = alpha_box,                          </span></span>
<span id="cb44-244"><a href="#cb44-244" aria-hidden="true" tabindex="-1"></a><span class="in">      color = col_repro,                          </span></span>
<span id="cb44-245"><a href="#cb44-245" aria-hidden="true" tabindex="-1"></a><span class="in">      fill = col_repro</span></span>
<span id="cb44-246"><a href="#cb44-246" aria-hidden="true" tabindex="-1"></a><span class="in">      )+</span></span>
<span id="cb44-247"><a href="#cb44-247" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-248"><a href="#cb44-248" aria-hidden="true" tabindex="-1"></a><span class="in">  # Points</span></span>
<span id="cb44-249"><a href="#cb44-249" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_dotplot(</span></span>
<span id="cb44-250"><a href="#cb44-250" aria-hidden="true" tabindex="-1"></a><span class="in">    binaxis='y', </span></span>
<span id="cb44-251"><a href="#cb44-251" aria-hidden="true" tabindex="-1"></a><span class="in">    stackdir='center', </span></span>
<span id="cb44-252"><a href="#cb44-252" aria-hidden="true" tabindex="-1"></a><span class="in">    dotsize=0.7, </span></span>
<span id="cb44-253"><a href="#cb44-253" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=0.9,                          </span></span>
<span id="cb44-254"><a href="#cb44-254" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_repro,</span></span>
<span id="cb44-255"><a href="#cb44-255" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = col_repro</span></span>
<span id="cb44-256"><a href="#cb44-256" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb44-257"><a href="#cb44-257" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-258"><a href="#cb44-258" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(                                         </span></span>
<span id="cb44-259"><a href="#cb44-259" aria-hidden="true" tabindex="-1"></a><span class="in">    x = "Dose en éther (mg/L)",              </span></span>
<span id="cb44-260"><a href="#cb44-260" aria-hidden="true" tabindex="-1"></a><span class="in">    y = "Nombre d'oeufs produits par les dragons (#)"</span></span>
<span id="cb44-261"><a href="#cb44-261" aria-hidden="true" tabindex="-1"></a><span class="in">  )+                                             </span></span>
<span id="cb44-262"><a href="#cb44-262" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal() </span></span>
<span id="cb44-263"><a href="#cb44-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-264"><a href="#cb44-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-265"><a href="#cb44-265" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- p_C + p_R +                                </span></span>
<span id="cb44-266"><a href="#cb44-266" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(ncol = 2)                        </span></span>
<span id="cb44-267"><a href="#cb44-267" aria-hidden="true" tabindex="-1"></a><span class="in">p </span></span>
<span id="cb44-268"><a href="#cb44-268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-269"><a href="#cb44-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-270"><a href="#cb44-270" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Le type de la variable dose doit être convertit en facteur</span>
<span id="cb44-271"><a href="#cb44-271" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Disposition des points</span>
<span id="cb44-272"><a href="#cb44-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-273"><a href="#cb44-273" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb44-274"><a href="#cb44-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-275"><a href="#cb44-275" aria-hidden="true" tabindex="-1"></a><span class="fu">## Etape 2 - Appliquer le modèle de Hill aux données</span></span>
<span id="cb44-276"><a href="#cb44-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-277"><a href="#cb44-277" aria-hidden="true" tabindex="-1"></a>Les modèles de Hill pour la croissance et la reproduction peuvent présenter des différences :</span>
<span id="cb44-278"><a href="#cb44-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-279"><a href="#cb44-279" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Pour la **reproduction**, la réponse minimale est connue et fixée à 0, car il est impossible d'observer un nombre d'œufs négatif.</span>
<span id="cb44-280"><a href="#cb44-280" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Pour la **croissance**, le taux minimal n'est pas toujours connu à l'avance, car il peut dépendre de facteurs biologiques et environnementaux.</span>
<span id="cb44-281"><a href="#cb44-281" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>La distribution des valeurs observées diffère entre les deux :</span>
<span id="cb44-282"><a href="#cb44-282" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>Le **taux de croissance** suit une distribution **normale**, car il résulte de variations continues influencées par de multiples facteurs.</span>
<span id="cb44-283"><a href="#cb44-283" aria-hidden="true" tabindex="-1"></a><span class="ss">  - </span>La **reproduction** suit une distribution de **Poisson**, car elle repose sur un comptage d'événements discrets (nombre d'œufs produits).</span>
<span id="cb44-284"><a href="#cb44-284" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb44-285"><a href="#cb44-285" aria-hidden="true" tabindex="-1"></a>Formellement, les modèles peuvent être écrit de la sorte avec $Y_i$ la réponse d'un individu $i$ exposé à une dose donnée :</span>
<span id="cb44-286"><a href="#cb44-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-287"><a href="#cb44-287" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-288"><a href="#cb44-288" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb44-289"><a href="#cb44-289" aria-hidden="true" tabindex="-1"></a>\text{Pour la croissance : }Y_i \sim \mathcal{N}(\text{Hill}(Dose_i), \sigma^2)</span>
<span id="cb44-290"><a href="#cb44-290" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb44-291"><a href="#cb44-291" aria-hidden="true" tabindex="-1"></a>$${#eq-drccroiss}</span>
<span id="cb44-292"><a href="#cb44-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-293"><a href="#cb44-293" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb44-294"><a href="#cb44-294" aria-hidden="true" tabindex="-1"></a>\begin{aligned}</span>
<span id="cb44-295"><a href="#cb44-295" aria-hidden="true" tabindex="-1"></a>\text{Pour la reproduction : }Y_i \sim \mathcal{P}(\text{Hill}(Dose_i))</span>
<span id="cb44-296"><a href="#cb44-296" aria-hidden="true" tabindex="-1"></a>\end{aligned}</span>
<span id="cb44-297"><a href="#cb44-297" aria-hidden="true" tabindex="-1"></a>$${#eq-drcrepro}</span>
<span id="cb44-298"><a href="#cb44-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-299"><a href="#cb44-299" aria-hidden="true" tabindex="-1"></a>La librairie <span class="in">`drc`</span> peut maintenant être utilisée. </span>
<span id="cb44-300"><a href="#cb44-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-301"><a href="#cb44-301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=F, warning= F}</span></span>
<span id="cb44-302"><a href="#cb44-302" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: show</span></span>
<span id="cb44-303"><a href="#cb44-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-304"><a href="#cb44-304" aria-hidden="true" tabindex="-1"></a><span class="in"># Modèle pour la croissance</span></span>
<span id="cb44-305"><a href="#cb44-305" aria-hidden="true" tabindex="-1"></a><span class="in">drc.croiss &lt;- drm(</span></span>
<span id="cb44-306"><a href="#cb44-306" aria-hidden="true" tabindex="-1"></a><span class="in">  Txcroiss ~ Dose,                              # &lt;1&gt;</span></span>
<span id="cb44-307"><a href="#cb44-307" aria-hidden="true" tabindex="-1"></a><span class="in">  data = df_sim_croiss,                         # &lt;2&gt;</span></span>
<span id="cb44-308"><a href="#cb44-308" aria-hidden="true" tabindex="-1"></a><span class="in">  fct = LL.4(                                   # &lt;3&gt;</span></span>
<span id="cb44-309"><a href="#cb44-309" aria-hidden="true" tabindex="-1"></a><span class="in">    names = c("slope", "Ymin", "Ymax", "EC50"), # &lt;4&gt;</span></span>
<span id="cb44-310"><a href="#cb44-310" aria-hidden="true" tabindex="-1"></a><span class="in">    fixed=c(NA, NA, NA, NA)                     # &lt;5&gt;</span></span>
<span id="cb44-311"><a href="#cb44-311" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb44-312"><a href="#cb44-312" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb44-313"><a href="#cb44-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-314"><a href="#cb44-314" aria-hidden="true" tabindex="-1"></a><span class="in"># Modèle pour la reproduction</span></span>
<span id="cb44-315"><a href="#cb44-315" aria-hidden="true" tabindex="-1"></a><span class="in">drc.repro &lt;- drm(</span></span>
<span id="cb44-316"><a href="#cb44-316" aria-hidden="true" tabindex="-1"></a><span class="in">  Oeuf ~ Dose,                                  </span></span>
<span id="cb44-317"><a href="#cb44-317" aria-hidden="true" tabindex="-1"></a><span class="in">  data = df_sim_repro,</span></span>
<span id="cb44-318"><a href="#cb44-318" aria-hidden="true" tabindex="-1"></a><span class="in">  type="Poisson",                               # &lt;6&gt;</span></span>
<span id="cb44-319"><a href="#cb44-319" aria-hidden="true" tabindex="-1"></a><span class="in">  fct = LL.4(                                   </span></span>
<span id="cb44-320"><a href="#cb44-320" aria-hidden="true" tabindex="-1"></a><span class="in">    names = c("slope", "Ymin", "Ymax", "EC50"), </span></span>
<span id="cb44-321"><a href="#cb44-321" aria-hidden="true" tabindex="-1"></a><span class="in">    fixed=c(NA, 0, NA, NA)                      </span></span>
<span id="cb44-322"><a href="#cb44-322" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb44-323"><a href="#cb44-323" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb44-324"><a href="#cb44-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-325"><a href="#cb44-325" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-326"><a href="#cb44-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-327"><a href="#cb44-327" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Spécification de la formule : Endpoint à modéliser = Taux de croissance en fonction de la dose</span>
<span id="cb44-328"><a href="#cb44-328" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Données à utiliser</span>
<span id="cb44-329"><a href="#cb44-329" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Spécification du type de modèle à utiliser. Il existe différentes variante mais le modèle de Hill (modèle log-logistique à 4 paramètres) est le plus couramment utilisé</span>
<span id="cb44-330"><a href="#cb44-330" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Re-définition du nom des variables du modèle pour qu'ils soient plus explicite</span>
<span id="cb44-331"><a href="#cb44-331" aria-hidden="true" tabindex="-1"></a><span class="ss">5. </span>Argument permettant de fixer la valeur de certains paramètres du modèle. NA est mis quand on ne veut pas les fixer mais les estimer.</span>
<span id="cb44-332"><a href="#cb44-332" aria-hidden="true" tabindex="-1"></a><span class="ss">6. </span>On spécifie que les résidus suivent une loi de Poisson.</span>
<span id="cb44-333"><a href="#cb44-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-334"><a href="#cb44-334" aria-hidden="true" tabindex="-1"></a>Résumé du modèle pour la croissance :</span>
<span id="cb44-335"><a href="#cb44-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-336"><a href="#cb44-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=F, warning=F}</span></span>
<span id="cb44-337"><a href="#cb44-337" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: show</span></span>
<span id="cb44-338"><a href="#cb44-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-339"><a href="#cb44-339" aria-hidden="true" tabindex="-1"></a><span class="in">summary(drc.croiss)</span></span>
<span id="cb44-340"><a href="#cb44-340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-341"><a href="#cb44-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-342"><a href="#cb44-342" aria-hidden="true" tabindex="-1"></a>Résumé du modèle pour la reproduction :</span>
<span id="cb44-343"><a href="#cb44-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-344"><a href="#cb44-344" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=F, warning=F}</span></span>
<span id="cb44-345"><a href="#cb44-345" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: show</span></span>
<span id="cb44-346"><a href="#cb44-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-347"><a href="#cb44-347" aria-hidden="true" tabindex="-1"></a><span class="in">summary(drc.repro)</span></span>
<span id="cb44-348"><a href="#cb44-348" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-349"><a href="#cb44-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-350"><a href="#cb44-350" aria-hidden="true" tabindex="-1"></a>Nous pouvons également extraire des EC$_{10}$ des ces modèles :</span>
<span id="cb44-351"><a href="#cb44-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-354"><a href="#cb44-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-355"><a href="#cb44-355" aria-hidden="true" tabindex="-1"></a>EC10_croiss <span class="ot">&lt;-</span> <span class="fu">ED</span>(drc.croiss, <span class="dv">10</span>, <span class="at">interval =</span> <span class="st">"delta"</span>)</span>
<span id="cb44-356"><a href="#cb44-356" aria-hidden="true" tabindex="-1"></a>EC10_repro <span class="ot">&lt;-</span> <span class="fu">ED</span>(drc.repro, <span class="dv">10</span>, <span class="at">interval =</span> <span class="st">"delta"</span>)</span>
<span id="cb44-357"><a href="#cb44-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-358"><a href="#cb44-358" aria-hidden="true" tabindex="-1"></a>EC10_croiss_show <span class="ot">&lt;-</span> <span class="fu">round</span>(EC10_croiss[<span class="dv">1</span>],<span class="dv">2</span>)</span>
<span id="cb44-359"><a href="#cb44-359" aria-hidden="true" tabindex="-1"></a>EC10_repro_show <span class="ot">&lt;-</span> <span class="fu">round</span>(EC10_repro[<span class="dv">1</span>],<span class="dv">2</span>)</span>
<span id="cb44-360"><a href="#cb44-360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-361"><a href="#cb44-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-362"><a href="#cb44-362" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Croissance : EC$_{10}$ = <span class="in">`r EC10_croiss_show`</span> mg/L</span>
<span id="cb44-363"><a href="#cb44-363" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Reproduction : EC$_{10}$ = <span class="in">`r EC10_repro_show`</span> mg/L</span>
<span id="cb44-364"><a href="#cb44-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-365"><a href="#cb44-365" aria-hidden="true" tabindex="-1"></a><span class="fu">## Etape 3 - Visualisation des résultats du modèle</span></span>
<span id="cb44-366"><a href="#cb44-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-367"><a href="#cb44-367" aria-hidden="true" tabindex="-1"></a>Pour pouvoir tracer les résultats du modèle proprement avec <span class="in">`ggplot`</span>, il faut faire quelque tour de passe-passe mais la fonction <span class="in">`plot(nom_du_modèle)`</span> peut simplement être utilisée. </span>
<span id="cb44-368"><a href="#cb44-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-369"><a href="#cb44-369" aria-hidden="true" tabindex="-1"></a>On définit une fonction de Hill pour chacun de nos endpoints. Puis, on créé des dataframes correspondant aux prédictions de la réponse de nos dragons pour un très grand nombre de doses. </span>
<span id="cb44-370"><a href="#cb44-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-371"><a href="#cb44-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=F, warning=F}</span></span>
<span id="cb44-372"><a href="#cb44-372" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: show</span></span>
<span id="cb44-373"><a href="#cb44-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-374"><a href="#cb44-374" aria-hidden="true" tabindex="-1"></a><span class="in">f_Hill_croiss &lt;- function(Dose){</span></span>
<span id="cb44-375"><a href="#cb44-375" aria-hidden="true" tabindex="-1"></a><span class="in">  slope &lt;- coef(drc.croiss)[1]</span></span>
<span id="cb44-376"><a href="#cb44-376" aria-hidden="true" tabindex="-1"></a><span class="in">  Y_min &lt;- coef(drc.croiss)[2]</span></span>
<span id="cb44-377"><a href="#cb44-377" aria-hidden="true" tabindex="-1"></a><span class="in">  Y_max &lt;- coef(drc.croiss)[3]</span></span>
<span id="cb44-378"><a href="#cb44-378" aria-hidden="true" tabindex="-1"></a><span class="in">  EC50 &lt;- coef(drc.croiss)[4]</span></span>
<span id="cb44-379"><a href="#cb44-379" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-380"><a href="#cb44-380" aria-hidden="true" tabindex="-1"></a><span class="in">  return(Y_min+(Y_max-Y_min)/(1+exp(slope*(log(Dose)-log(EC50)))))</span></span>
<span id="cb44-381"><a href="#cb44-381" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb44-382"><a href="#cb44-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-383"><a href="#cb44-383" aria-hidden="true" tabindex="-1"></a><span class="in">f_Hill_repro &lt;- function(Dose){</span></span>
<span id="cb44-384"><a href="#cb44-384" aria-hidden="true" tabindex="-1"></a><span class="in">  slope &lt;- coef(drc.repro)[1]</span></span>
<span id="cb44-385"><a href="#cb44-385" aria-hidden="true" tabindex="-1"></a><span class="in">  Y_min &lt;- 0</span></span>
<span id="cb44-386"><a href="#cb44-386" aria-hidden="true" tabindex="-1"></a><span class="in">  Y_max &lt;- coef(drc.repro)[2]</span></span>
<span id="cb44-387"><a href="#cb44-387" aria-hidden="true" tabindex="-1"></a><span class="in">  EC50 &lt;- coef(drc.repro)[3]</span></span>
<span id="cb44-388"><a href="#cb44-388" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-389"><a href="#cb44-389" aria-hidden="true" tabindex="-1"></a><span class="in">  return(Y_min+(Y_max-Y_min)/(1+exp(slope*(log(Dose)-log(EC50)))))</span></span>
<span id="cb44-390"><a href="#cb44-390" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb44-391"><a href="#cb44-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-392"><a href="#cb44-392" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0.01, 5000, 0.01)</span></span>
<span id="cb44-393"><a href="#cb44-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-394"><a href="#cb44-394" aria-hidden="true" tabindex="-1"></a><span class="in">df_drc_croiss &lt;- data.frame(</span></span>
<span id="cb44-395"><a href="#cb44-395" aria-hidden="true" tabindex="-1"></a><span class="in">  x=x,</span></span>
<span id="cb44-396"><a href="#cb44-396" aria-hidden="true" tabindex="-1"></a><span class="in">  y=f_Hill_croiss(x)</span></span>
<span id="cb44-397"><a href="#cb44-397" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb44-398"><a href="#cb44-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-399"><a href="#cb44-399" aria-hidden="true" tabindex="-1"></a><span class="in">df_drc_repro &lt;- data.frame(</span></span>
<span id="cb44-400"><a href="#cb44-400" aria-hidden="true" tabindex="-1"></a><span class="in">  x=x,</span></span>
<span id="cb44-401"><a href="#cb44-401" aria-hidden="true" tabindex="-1"></a><span class="in">  y=f_Hill_repro(x)</span></span>
<span id="cb44-402"><a href="#cb44-402" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb44-403"><a href="#cb44-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-404"><a href="#cb44-404" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-405"><a href="#cb44-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-406"><a href="#cb44-406" aria-hidden="true" tabindex="-1"></a>Il faut également qu'on puisse afficher les intervalles de confiance à 95% de notre modèle. </span>
<span id="cb44-407"><a href="#cb44-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-408"><a href="#cb44-408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=F, warning=F}</span></span>
<span id="cb44-409"><a href="#cb44-409" aria-hidden="true" tabindex="-1"></a><span class="in">#| code-fold: show</span></span>
<span id="cb44-410"><a href="#cb44-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-411"><a href="#cb44-411" aria-hidden="true" tabindex="-1"></a><span class="in">Dose_x &lt;- expand.grid(</span></span>
<span id="cb44-412"><a href="#cb44-412" aria-hidden="true" tabindex="-1"></a><span class="in">  exp(</span></span>
<span id="cb44-413"><a href="#cb44-413" aria-hidden="true" tabindex="-1"></a><span class="in">    seq(</span></span>
<span id="cb44-414"><a href="#cb44-414" aria-hidden="true" tabindex="-1"></a><span class="in">      log(0.01),log(5000), </span></span>
<span id="cb44-415"><a href="#cb44-415" aria-hidden="true" tabindex="-1"></a><span class="in">      by=(log(5000)-log(0.01))/100</span></span>
<span id="cb44-416"><a href="#cb44-416" aria-hidden="true" tabindex="-1"></a><span class="in">      )</span></span>
<span id="cb44-417"><a href="#cb44-417" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb44-418"><a href="#cb44-418" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb44-419"><a href="#cb44-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-420"><a href="#cb44-420" aria-hidden="true" tabindex="-1"></a><span class="in">CI.croiss &lt;- data.frame(</span></span>
<span id="cb44-421"><a href="#cb44-421" aria-hidden="true" tabindex="-1"></a><span class="in">  Dose=Dose_x$Var1</span></span>
<span id="cb44-422"><a href="#cb44-422" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb44-423"><a href="#cb44-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-424"><a href="#cb44-424" aria-hidden="true" tabindex="-1"></a><span class="in">pm.croiss &lt;- predict(drc.croiss, newdata=CI.croiss, interval="confidence")</span></span>
<span id="cb44-425"><a href="#cb44-425" aria-hidden="true" tabindex="-1"></a><span class="in">CI.croiss$p &lt;- pm.croiss[,1]</span></span>
<span id="cb44-426"><a href="#cb44-426" aria-hidden="true" tabindex="-1"></a><span class="in">CI.croiss$pmin &lt;- pm.croiss[,2]</span></span>
<span id="cb44-427"><a href="#cb44-427" aria-hidden="true" tabindex="-1"></a><span class="in">CI.croiss$pmax &lt;- pm.croiss[,3]</span></span>
<span id="cb44-428"><a href="#cb44-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-429"><a href="#cb44-429" aria-hidden="true" tabindex="-1"></a><span class="in">CI.repro &lt;- data.frame(</span></span>
<span id="cb44-430"><a href="#cb44-430" aria-hidden="true" tabindex="-1"></a><span class="in">  Dose=Dose_x$Var1</span></span>
<span id="cb44-431"><a href="#cb44-431" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb44-432"><a href="#cb44-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-433"><a href="#cb44-433" aria-hidden="true" tabindex="-1"></a><span class="in">pm.repro &lt;- predict(drc.repro, newdata=CI.repro, interval="confidence")</span></span>
<span id="cb44-434"><a href="#cb44-434" aria-hidden="true" tabindex="-1"></a><span class="in">CI.repro$p &lt;- pm.repro[,1]</span></span>
<span id="cb44-435"><a href="#cb44-435" aria-hidden="true" tabindex="-1"></a><span class="in">CI.repro$pmin &lt;- pm.repro[,2]</span></span>
<span id="cb44-436"><a href="#cb44-436" aria-hidden="true" tabindex="-1"></a><span class="in">CI.repro$pmax &lt;- pm.repro[,3]</span></span>
<span id="cb44-437"><a href="#cb44-437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-438"><a href="#cb44-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-439"><a href="#cb44-439" aria-hidden="true" tabindex="-1"></a>Grâce à tout cela on peut enfin tracer nos graphiques.</span>
<span id="cb44-440"><a href="#cb44-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-441"><a href="#cb44-441" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=F, warning=F}</span></span>
<span id="cb44-442"><a href="#cb44-442" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Taux de croissance et production d'oeufs des dragons en fonction de la dose d'éther</span></span>
<span id="cb44-443"><a href="#cb44-443" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-drcdragon</span></span>
<span id="cb44-444"><a href="#cb44-444" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 8</span></span>
<span id="cb44-445"><a href="#cb44-445" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 4</span></span>
<span id="cb44-446"><a href="#cb44-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-447"><a href="#cb44-447" aria-hidden="true" tabindex="-1"></a><span class="in"># Paramètres des graphiques </span></span>
<span id="cb44-448"><a href="#cb44-448" aria-hidden="true" tabindex="-1"></a><span class="in">size_mean &lt;- 3</span></span>
<span id="cb44-449"><a href="#cb44-449" aria-hidden="true" tabindex="-1"></a><span class="in">alpha_rep &lt;- 0.5</span></span>
<span id="cb44-450"><a href="#cb44-450" aria-hidden="true" tabindex="-1"></a><span class="in">alpha_ribbon &lt;- 0.2</span></span>
<span id="cb44-451"><a href="#cb44-451" aria-hidden="true" tabindex="-1"></a><span class="in">line_width &lt;- 1.2 </span></span>
<span id="cb44-452"><a href="#cb44-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-453"><a href="#cb44-453" aria-hidden="true" tabindex="-1"></a><span class="in">p_drc_C &lt;- ggplot()+</span></span>
<span id="cb44-454"><a href="#cb44-454" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-455"><a href="#cb44-455" aria-hidden="true" tabindex="-1"></a><span class="in">  # Affichage des intervalles de confiance à 95%</span></span>
<span id="cb44-456"><a href="#cb44-456" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_ribbon(</span></span>
<span id="cb44-457"><a href="#cb44-457" aria-hidden="true" tabindex="-1"></a><span class="in">    data=CI.croiss, </span></span>
<span id="cb44-458"><a href="#cb44-458" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb44-459"><a href="#cb44-459" aria-hidden="true" tabindex="-1"></a><span class="in">      x=Dose, </span></span>
<span id="cb44-460"><a href="#cb44-460" aria-hidden="true" tabindex="-1"></a><span class="in">      y=p, </span></span>
<span id="cb44-461"><a href="#cb44-461" aria-hidden="true" tabindex="-1"></a><span class="in">      ymin=pmin, ymax=pmax</span></span>
<span id="cb44-462"><a href="#cb44-462" aria-hidden="true" tabindex="-1"></a><span class="in">      ), </span></span>
<span id="cb44-463"><a href="#cb44-463" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=alpha_ribbon,</span></span>
<span id="cb44-464"><a href="#cb44-464" aria-hidden="true" tabindex="-1"></a><span class="in">    #color = col_croiss,</span></span>
<span id="cb44-465"><a href="#cb44-465" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = col_croiss</span></span>
<span id="cb44-466"><a href="#cb44-466" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb44-467"><a href="#cb44-467" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-468"><a href="#cb44-468" aria-hidden="true" tabindex="-1"></a><span class="in">  # Affichage de la courbe prédite par le modèle</span></span>
<span id="cb44-469"><a href="#cb44-469" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(</span></span>
<span id="cb44-470"><a href="#cb44-470" aria-hidden="true" tabindex="-1"></a><span class="in">    data = df_drc_croiss, </span></span>
<span id="cb44-471"><a href="#cb44-471" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb44-472"><a href="#cb44-472" aria-hidden="true" tabindex="-1"></a><span class="in">      x=x, </span></span>
<span id="cb44-473"><a href="#cb44-473" aria-hidden="true" tabindex="-1"></a><span class="in">      y=y</span></span>
<span id="cb44-474"><a href="#cb44-474" aria-hidden="true" tabindex="-1"></a><span class="in">      ),</span></span>
<span id="cb44-475"><a href="#cb44-475" aria-hidden="true" tabindex="-1"></a><span class="in">    linewidth = line_width,</span></span>
<span id="cb44-476"><a href="#cb44-476" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_croiss</span></span>
<span id="cb44-477"><a href="#cb44-477" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb44-478"><a href="#cb44-478" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-479"><a href="#cb44-479" aria-hidden="true" tabindex="-1"></a><span class="in">  # On réaffiche nos données de la même manière que précédement</span></span>
<span id="cb44-480"><a href="#cb44-480" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(</span></span>
<span id="cb44-481"><a href="#cb44-481" aria-hidden="true" tabindex="-1"></a><span class="in">    data=df_sim_croiss, </span></span>
<span id="cb44-482"><a href="#cb44-482" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb44-483"><a href="#cb44-483" aria-hidden="true" tabindex="-1"></a><span class="in">      x=Dose, </span></span>
<span id="cb44-484"><a href="#cb44-484" aria-hidden="true" tabindex="-1"></a><span class="in">      y=Txcroiss</span></span>
<span id="cb44-485"><a href="#cb44-485" aria-hidden="true" tabindex="-1"></a><span class="in">      ), </span></span>
<span id="cb44-486"><a href="#cb44-486" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=alpha_rep,</span></span>
<span id="cb44-487"><a href="#cb44-487" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_croiss</span></span>
<span id="cb44-488"><a href="#cb44-488" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb44-489"><a href="#cb44-489" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(</span></span>
<span id="cb44-490"><a href="#cb44-490" aria-hidden="true" tabindex="-1"></a><span class="in">    data=df_sim_croiss_mean, </span></span>
<span id="cb44-491"><a href="#cb44-491" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb44-492"><a href="#cb44-492" aria-hidden="true" tabindex="-1"></a><span class="in">      x=Dose, </span></span>
<span id="cb44-493"><a href="#cb44-493" aria-hidden="true" tabindex="-1"></a><span class="in">      y=Txcroiss</span></span>
<span id="cb44-494"><a href="#cb44-494" aria-hidden="true" tabindex="-1"></a><span class="in">      ), </span></span>
<span id="cb44-495"><a href="#cb44-495" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=1,</span></span>
<span id="cb44-496"><a href="#cb44-496" aria-hidden="true" tabindex="-1"></a><span class="in">    size = size_mean,</span></span>
<span id="cb44-497"><a href="#cb44-497" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_croiss</span></span>
<span id="cb44-498"><a href="#cb44-498" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb44-499"><a href="#cb44-499" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-500"><a href="#cb44-500" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_log10()+</span></span>
<span id="cb44-501"><a href="#cb44-501" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-502"><a href="#cb44-502" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb44-503"><a href="#cb44-503" aria-hidden="true" tabindex="-1"></a><span class="in">  x="Dose en éther (mg/kg)",</span></span>
<span id="cb44-504"><a href="#cb44-504" aria-hidden="true" tabindex="-1"></a><span class="in">  y="Taux de croissance des dragons (kg/jour)"</span></span>
<span id="cb44-505"><a href="#cb44-505" aria-hidden="true" tabindex="-1"></a><span class="in">  )+</span></span>
<span id="cb44-506"><a href="#cb44-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-507"><a href="#cb44-507" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()</span></span>
<span id="cb44-508"><a href="#cb44-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-509"><a href="#cb44-509" aria-hidden="true" tabindex="-1"></a><span class="in">p_drc_R &lt;- ggplot()+</span></span>
<span id="cb44-510"><a href="#cb44-510" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-511"><a href="#cb44-511" aria-hidden="true" tabindex="-1"></a><span class="in">  # Affichage des intervalles de confiance à 95%</span></span>
<span id="cb44-512"><a href="#cb44-512" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_ribbon(</span></span>
<span id="cb44-513"><a href="#cb44-513" aria-hidden="true" tabindex="-1"></a><span class="in">    data=CI.repro, </span></span>
<span id="cb44-514"><a href="#cb44-514" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb44-515"><a href="#cb44-515" aria-hidden="true" tabindex="-1"></a><span class="in">      x=Dose, </span></span>
<span id="cb44-516"><a href="#cb44-516" aria-hidden="true" tabindex="-1"></a><span class="in">      y=p, </span></span>
<span id="cb44-517"><a href="#cb44-517" aria-hidden="true" tabindex="-1"></a><span class="in">      ymin=pmin, ymax=pmax</span></span>
<span id="cb44-518"><a href="#cb44-518" aria-hidden="true" tabindex="-1"></a><span class="in">      ), </span></span>
<span id="cb44-519"><a href="#cb44-519" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=alpha_ribbon,</span></span>
<span id="cb44-520"><a href="#cb44-520" aria-hidden="true" tabindex="-1"></a><span class="in">    #color = col_repro,</span></span>
<span id="cb44-521"><a href="#cb44-521" aria-hidden="true" tabindex="-1"></a><span class="in">    fill = col_repro</span></span>
<span id="cb44-522"><a href="#cb44-522" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb44-523"><a href="#cb44-523" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-524"><a href="#cb44-524" aria-hidden="true" tabindex="-1"></a><span class="in">  # Affichage de la courbe prédite par le modèle</span></span>
<span id="cb44-525"><a href="#cb44-525" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(</span></span>
<span id="cb44-526"><a href="#cb44-526" aria-hidden="true" tabindex="-1"></a><span class="in">    data = df_drc_repro, </span></span>
<span id="cb44-527"><a href="#cb44-527" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb44-528"><a href="#cb44-528" aria-hidden="true" tabindex="-1"></a><span class="in">      x=x, </span></span>
<span id="cb44-529"><a href="#cb44-529" aria-hidden="true" tabindex="-1"></a><span class="in">      y=y</span></span>
<span id="cb44-530"><a href="#cb44-530" aria-hidden="true" tabindex="-1"></a><span class="in">      ),</span></span>
<span id="cb44-531"><a href="#cb44-531" aria-hidden="true" tabindex="-1"></a><span class="in">    linewidth = line_width,</span></span>
<span id="cb44-532"><a href="#cb44-532" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_repro</span></span>
<span id="cb44-533"><a href="#cb44-533" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb44-534"><a href="#cb44-534" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-535"><a href="#cb44-535" aria-hidden="true" tabindex="-1"></a><span class="in">  # On réaffiche nos données de la même manière que précédement</span></span>
<span id="cb44-536"><a href="#cb44-536" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(</span></span>
<span id="cb44-537"><a href="#cb44-537" aria-hidden="true" tabindex="-1"></a><span class="in">    data=df_sim_repro, </span></span>
<span id="cb44-538"><a href="#cb44-538" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb44-539"><a href="#cb44-539" aria-hidden="true" tabindex="-1"></a><span class="in">      x=Dose, </span></span>
<span id="cb44-540"><a href="#cb44-540" aria-hidden="true" tabindex="-1"></a><span class="in">      y=Oeuf</span></span>
<span id="cb44-541"><a href="#cb44-541" aria-hidden="true" tabindex="-1"></a><span class="in">      ), </span></span>
<span id="cb44-542"><a href="#cb44-542" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=alpha_rep,</span></span>
<span id="cb44-543"><a href="#cb44-543" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_repro</span></span>
<span id="cb44-544"><a href="#cb44-544" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb44-545"><a href="#cb44-545" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(</span></span>
<span id="cb44-546"><a href="#cb44-546" aria-hidden="true" tabindex="-1"></a><span class="in">    data=df_sim_repro_mean, </span></span>
<span id="cb44-547"><a href="#cb44-547" aria-hidden="true" tabindex="-1"></a><span class="in">    aes(</span></span>
<span id="cb44-548"><a href="#cb44-548" aria-hidden="true" tabindex="-1"></a><span class="in">      x=Dose, </span></span>
<span id="cb44-549"><a href="#cb44-549" aria-hidden="true" tabindex="-1"></a><span class="in">      y=Oeuf</span></span>
<span id="cb44-550"><a href="#cb44-550" aria-hidden="true" tabindex="-1"></a><span class="in">      ), </span></span>
<span id="cb44-551"><a href="#cb44-551" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=1,</span></span>
<span id="cb44-552"><a href="#cb44-552" aria-hidden="true" tabindex="-1"></a><span class="in">    size = size_mean,</span></span>
<span id="cb44-553"><a href="#cb44-553" aria-hidden="true" tabindex="-1"></a><span class="in">    color = col_repro</span></span>
<span id="cb44-554"><a href="#cb44-554" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb44-555"><a href="#cb44-555" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-556"><a href="#cb44-556" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_log10()+</span></span>
<span id="cb44-557"><a href="#cb44-557" aria-hidden="true" tabindex="-1"></a><span class="in">  </span></span>
<span id="cb44-558"><a href="#cb44-558" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb44-559"><a href="#cb44-559" aria-hidden="true" tabindex="-1"></a><span class="in">  x="Dose en éther (mg/kg)",</span></span>
<span id="cb44-560"><a href="#cb44-560" aria-hidden="true" tabindex="-1"></a><span class="in">  y="Nombre d'oeuf produits par les dragons (#)"</span></span>
<span id="cb44-561"><a href="#cb44-561" aria-hidden="true" tabindex="-1"></a><span class="in">  )+</span></span>
<span id="cb44-562"><a href="#cb44-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-563"><a href="#cb44-563" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()</span></span>
<span id="cb44-564"><a href="#cb44-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-565"><a href="#cb44-565" aria-hidden="true" tabindex="-1"></a><span class="in">p &lt;- p_drc_C + p_drc_R +                              </span></span>
<span id="cb44-566"><a href="#cb44-566" aria-hidden="true" tabindex="-1"></a><span class="in">  plot_layout(ncol = 2)                        </span></span>
<span id="cb44-567"><a href="#cb44-567" aria-hidden="true" tabindex="-1"></a><span class="in">p</span></span>
<span id="cb44-568"><a href="#cb44-568" aria-hidden="true" tabindex="-1"></a><span class="in">    </span></span>
<span id="cb44-569"><a href="#cb44-569" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-570"><a href="#cb44-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-571"><a href="#cb44-571" aria-hidden="true" tabindex="-1"></a><span class="fu">## Etape 4 - Validation du modèle</span></span>
<span id="cb44-572"><a href="#cb44-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-573"><a href="#cb44-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-574"><a href="#cb44-574" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=F, message=F}</span></span>
<span id="cb44-575"><a href="#cb44-575" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-cap: Diagnostic graphs</span></span>
<span id="cb44-576"><a href="#cb44-576" aria-hidden="true" tabindex="-1"></a><span class="in">#| label: fig-drcdiag</span></span>
<span id="cb44-577"><a href="#cb44-577" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-width: 8</span></span>
<span id="cb44-578"><a href="#cb44-578" aria-hidden="true" tabindex="-1"></a><span class="in">#| fig-height: 6</span></span>
<span id="cb44-579"><a href="#cb44-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-580"><a href="#cb44-580" aria-hidden="true" tabindex="-1"></a><span class="in">plot_QQ.croiss &lt;- ggplot(</span></span>
<span id="cb44-581"><a href="#cb44-581" aria-hidden="true" tabindex="-1"></a><span class="in">  mapping=aes(</span></span>
<span id="cb44-582"><a href="#cb44-582" aria-hidden="true" tabindex="-1"></a><span class="in">    sample=residuals(drc.croiss)</span></span>
<span id="cb44-583"><a href="#cb44-583" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb44-584"><a href="#cb44-584" aria-hidden="true" tabindex="-1"></a><span class="in">  )+</span></span>
<span id="cb44-585"><a href="#cb44-585" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_qq(</span></span>
<span id="cb44-586"><a href="#cb44-586" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=0.3,</span></span>
<span id="cb44-587"><a href="#cb44-587" aria-hidden="true" tabindex="-1"></a><span class="in">    color=col_croiss</span></span>
<span id="cb44-588"><a href="#cb44-588" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb44-589"><a href="#cb44-589" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_qq_line(color=col_croiss)+</span></span>
<span id="cb44-590"><a href="#cb44-590" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb44-591"><a href="#cb44-591" aria-hidden="true" tabindex="-1"></a><span class="in">    x="Normal quantiles", </span></span>
<span id="cb44-592"><a href="#cb44-592" aria-hidden="true" tabindex="-1"></a><span class="in">    y="Residuals",</span></span>
<span id="cb44-593"><a href="#cb44-593" aria-hidden="true" tabindex="-1"></a><span class="in">    title = "Croissance"</span></span>
<span id="cb44-594"><a href="#cb44-594" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb44-595"><a href="#cb44-595" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()</span></span>
<span id="cb44-596"><a href="#cb44-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-597"><a href="#cb44-597" aria-hidden="true" tabindex="-1"></a><span class="in">plot_resfit.croiss &lt;- ggplot()+</span></span>
<span id="cb44-598"><a href="#cb44-598" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(</span></span>
<span id="cb44-599"><a href="#cb44-599" aria-hidden="true" tabindex="-1"></a><span class="in">    mapping=aes(</span></span>
<span id="cb44-600"><a href="#cb44-600" aria-hidden="true" tabindex="-1"></a><span class="in">      x=fitted(drc.croiss), </span></span>
<span id="cb44-601"><a href="#cb44-601" aria-hidden="true" tabindex="-1"></a><span class="in">      y=residuals(drc.croiss)</span></span>
<span id="cb44-602"><a href="#cb44-602" aria-hidden="true" tabindex="-1"></a><span class="in">      ), </span></span>
<span id="cb44-603"><a href="#cb44-603" aria-hidden="true" tabindex="-1"></a><span class="in">    color=col_croiss, </span></span>
<span id="cb44-604"><a href="#cb44-604" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=0.3</span></span>
<span id="cb44-605"><a href="#cb44-605" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb44-606"><a href="#cb44-606" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb44-607"><a href="#cb44-607" aria-hidden="true" tabindex="-1"></a><span class="in">    x="Fitted", </span></span>
<span id="cb44-608"><a href="#cb44-608" aria-hidden="true" tabindex="-1"></a><span class="in">    y="Residuals",</span></span>
<span id="cb44-609"><a href="#cb44-609" aria-hidden="true" tabindex="-1"></a><span class="in">    title = "Croissance"</span></span>
<span id="cb44-610"><a href="#cb44-610" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb44-611"><a href="#cb44-611" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_log10()+</span></span>
<span id="cb44-612"><a href="#cb44-612" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()</span></span>
<span id="cb44-613"><a href="#cb44-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-614"><a href="#cb44-614" aria-hidden="true" tabindex="-1"></a><span class="in">plot_QQ.repro &lt;- ggplot(</span></span>
<span id="cb44-615"><a href="#cb44-615" aria-hidden="true" tabindex="-1"></a><span class="in">  mapping=aes(</span></span>
<span id="cb44-616"><a href="#cb44-616" aria-hidden="true" tabindex="-1"></a><span class="in">    sample=residuals(drc.repro)</span></span>
<span id="cb44-617"><a href="#cb44-617" aria-hidden="true" tabindex="-1"></a><span class="in">    )</span></span>
<span id="cb44-618"><a href="#cb44-618" aria-hidden="true" tabindex="-1"></a><span class="in">  )+</span></span>
<span id="cb44-619"><a href="#cb44-619" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_qq(</span></span>
<span id="cb44-620"><a href="#cb44-620" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=0.3,</span></span>
<span id="cb44-621"><a href="#cb44-621" aria-hidden="true" tabindex="-1"></a><span class="in">    color=col_repro</span></span>
<span id="cb44-622"><a href="#cb44-622" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb44-623"><a href="#cb44-623" aria-hidden="true" tabindex="-1"></a><span class="in">  stat_qq_line(color=col_repro)+</span></span>
<span id="cb44-624"><a href="#cb44-624" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb44-625"><a href="#cb44-625" aria-hidden="true" tabindex="-1"></a><span class="in">    x="Normal quantiles", </span></span>
<span id="cb44-626"><a href="#cb44-626" aria-hidden="true" tabindex="-1"></a><span class="in">    y="Residuals",</span></span>
<span id="cb44-627"><a href="#cb44-627" aria-hidden="true" tabindex="-1"></a><span class="in">    title = "Reproduction"</span></span>
<span id="cb44-628"><a href="#cb44-628" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb44-629"><a href="#cb44-629" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()</span></span>
<span id="cb44-630"><a href="#cb44-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-631"><a href="#cb44-631" aria-hidden="true" tabindex="-1"></a><span class="in">plot_resfit.repro &lt;- ggplot()+</span></span>
<span id="cb44-632"><a href="#cb44-632" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(</span></span>
<span id="cb44-633"><a href="#cb44-633" aria-hidden="true" tabindex="-1"></a><span class="in">    mapping=aes(</span></span>
<span id="cb44-634"><a href="#cb44-634" aria-hidden="true" tabindex="-1"></a><span class="in">      x=fitted(drc.repro), </span></span>
<span id="cb44-635"><a href="#cb44-635" aria-hidden="true" tabindex="-1"></a><span class="in">      y=residuals(drc.repro)</span></span>
<span id="cb44-636"><a href="#cb44-636" aria-hidden="true" tabindex="-1"></a><span class="in">      ), </span></span>
<span id="cb44-637"><a href="#cb44-637" aria-hidden="true" tabindex="-1"></a><span class="in">    color=col_repro, </span></span>
<span id="cb44-638"><a href="#cb44-638" aria-hidden="true" tabindex="-1"></a><span class="in">    alpha=0.3</span></span>
<span id="cb44-639"><a href="#cb44-639" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb44-640"><a href="#cb44-640" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(</span></span>
<span id="cb44-641"><a href="#cb44-641" aria-hidden="true" tabindex="-1"></a><span class="in">    x="Fitted", </span></span>
<span id="cb44-642"><a href="#cb44-642" aria-hidden="true" tabindex="-1"></a><span class="in">    y="Residuals",</span></span>
<span id="cb44-643"><a href="#cb44-643" aria-hidden="true" tabindex="-1"></a><span class="in">    title = "Reproduction"</span></span>
<span id="cb44-644"><a href="#cb44-644" aria-hidden="true" tabindex="-1"></a><span class="in">    )+</span></span>
<span id="cb44-645"><a href="#cb44-645" aria-hidden="true" tabindex="-1"></a><span class="in">  scale_x_log10()+</span></span>
<span id="cb44-646"><a href="#cb44-646" aria-hidden="true" tabindex="-1"></a><span class="in">  theme_minimal()</span></span>
<span id="cb44-647"><a href="#cb44-647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-648"><a href="#cb44-648" aria-hidden="true" tabindex="-1"></a><span class="in">plot &lt;- plot_resfit.croiss + plot_QQ.croiss + plot_resfit.repro + plot_QQ.repro + plot_layout(ncol=2)</span></span>
<span id="cb44-649"><a href="#cb44-649" aria-hidden="true" tabindex="-1"></a><span class="in">plot</span></span>
<span id="cb44-650"><a href="#cb44-650" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-651"><a href="#cb44-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-652"><a href="#cb44-652" aria-hidden="true" tabindex="-1"></a>Test de la normalité des résidus : </span>
<span id="cb44-653"><a href="#cb44-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-656"><a href="#cb44-656" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-657"><a href="#cb44-657" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(drc.croiss))</span>
<span id="cb44-658"><a href="#cb44-658" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(<span class="fu">residuals</span>(drc.repro))</span>
<span id="cb44-659"><a href="#cb44-659" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-660"><a href="#cb44-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-661"><a href="#cb44-661" aria-hidden="true" tabindex="-1"></a>L’hypothèse nulle spécifie la normalité des résidus, alors que l’hypothèse alternative spécifie la non-normalité. La p-value étant &gt;0.05, rien ne permet de rejeter cette hypothèse de normalité.</span>
<span id="cb44-662"><a href="#cb44-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-663"><a href="#cb44-663" aria-hidden="true" tabindex="-1"></a>Test de l'homogénéité des résidus :</span>
<span id="cb44-664"><a href="#cb44-664" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-667"><a href="#cb44-667" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-668"><a href="#cb44-668" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(</span>
<span id="cb44-669"><a href="#cb44-669" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>(drc.croiss), </span>
<span id="cb44-670"><a href="#cb44-670" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>(df_sim_croiss<span class="sc">$</span>Dose)</span>
<span id="cb44-671"><a href="#cb44-671" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb44-672"><a href="#cb44-672" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(</span>
<span id="cb44-673"><a href="#cb44-673" aria-hidden="true" tabindex="-1"></a>  <span class="fu">residuals</span>(drc.repro), </span>
<span id="cb44-674"><a href="#cb44-674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.factor</span>(df_sim_repro<span class="sc">$</span>Dose)</span>
<span id="cb44-675"><a href="#cb44-675" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb44-676"><a href="#cb44-676" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-677"><a href="#cb44-677" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-678"><a href="#cb44-678" aria-hidden="true" tabindex="-1"></a>L’hypothèse nulle spécifie l'homogénéité des résidus, alors que l’hypothèse alternative spécifie leur hétérogénéité. La p-value étant &gt;0.05, rien ne permet de rejeter cette hypothèse d'homogénéité des résidus.</span>
<span id="cb44-679"><a href="#cb44-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-680"><a href="#cb44-680" aria-hidden="true" tabindex="-1"></a><span class="fu">## Etape 5 - Détermination de la NOEC et de la LOEC</span></span>
<span id="cb44-681"><a href="#cb44-681" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-682"><a href="#cb44-682" aria-hidden="true" tabindex="-1"></a>Pour déterminer la NOEC et la LOEC, il faut regarder si nos points expérimentaux sont significativement différents entre eux.</span>
<span id="cb44-683"><a href="#cb44-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-684"><a href="#cb44-684" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pour la croissance </span></span>
<span id="cb44-685"><a href="#cb44-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-688"><a href="#cb44-688" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-689"><a href="#cb44-689" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(df_sim_croiss<span class="sc">$</span>Txcroiss)  </span>
<span id="cb44-690"><a href="#cb44-690" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-691"><a href="#cb44-691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-692"><a href="#cb44-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-695"><a href="#cb44-695" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-696"><a href="#cb44-696" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(</span>
<span id="cb44-697"><a href="#cb44-697" aria-hidden="true" tabindex="-1"></a>  Txcroiss<span class="sc">~</span>Dose_f,</span>
<span id="cb44-698"><a href="#cb44-698" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>df_sim_croiss</span>
<span id="cb44-699"><a href="#cb44-699" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-700"><a href="#cb44-700" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-701"><a href="#cb44-701" aria-hidden="true" tabindex="-1"></a>L'hypothèse de normalité des données et d'homogénéité des variances sont vérifiées.</span>
<span id="cb44-702"><a href="#cb44-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-703"><a href="#cb44-703" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=F}</span></span>
<span id="cb44-704"><a href="#cb44-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-705"><a href="#cb44-705" aria-hidden="true" tabindex="-1"></a><span class="in">lm.croiss &lt;- aov(Txcroiss ~ Dose_f, data = df_sim_croiss)</span></span>
<span id="cb44-706"><a href="#cb44-706" aria-hidden="true" tabindex="-1"></a><span class="in">summary(lm.croiss)</span></span>
<span id="cb44-707"><a href="#cb44-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-708"><a href="#cb44-708" aria-hidden="true" tabindex="-1"></a><span class="in">dunnett.test.croiss &lt;- glht(lm.croiss, linfct = mcp(Dose_f = "Dunnett"))</span></span>
<span id="cb44-709"><a href="#cb44-709" aria-hidden="true" tabindex="-1"></a><span class="in">summary(dunnett.test.croiss)</span></span>
<span id="cb44-710"><a href="#cb44-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-711"><a href="#cb44-711" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-712"><a href="#cb44-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-713"><a href="#cb44-713" aria-hidden="true" tabindex="-1"></a>D'après ces résultats, on en déduit que pour notre jeu de données :</span>
<span id="cb44-714"><a href="#cb44-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-715"><a href="#cb44-715" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>NOEC = 50 mg/L</span>
<span id="cb44-716"><a href="#cb44-716" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>LOEC = 107.7 mg/L</span>
<span id="cb44-717"><a href="#cb44-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-718"><a href="#cb44-718" aria-hidden="true" tabindex="-1"></a><span class="fu">### Pour la reproduction</span></span>
<span id="cb44-719"><a href="#cb44-719" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-722"><a href="#cb44-722" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-723"><a href="#cb44-723" aria-hidden="true" tabindex="-1"></a><span class="fu">shapiro.test</span>(df_sim_repro<span class="sc">$</span>Oeuf)  </span>
<span id="cb44-724"><a href="#cb44-724" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-725"><a href="#cb44-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-728"><a href="#cb44-728" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-729"><a href="#cb44-729" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(</span>
<span id="cb44-730"><a href="#cb44-730" aria-hidden="true" tabindex="-1"></a>  Oeuf<span class="sc">~</span>Dose_f,</span>
<span id="cb44-731"><a href="#cb44-731" aria-hidden="true" tabindex="-1"></a>  <span class="at">data=</span>df_sim_repro</span>
<span id="cb44-732"><a href="#cb44-732" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb44-733"><a href="#cb44-733" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-734"><a href="#cb44-734" aria-hidden="true" tabindex="-1"></a>L'hypothèse de normalité des données et d'homogénéité des variances sont vérifiées.</span>
<span id="cb44-735"><a href="#cb44-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-736"><a href="#cb44-736" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=F}</span></span>
<span id="cb44-737"><a href="#cb44-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-738"><a href="#cb44-738" aria-hidden="true" tabindex="-1"></a><span class="in">lm.repro &lt;- aov(Oeuf ~ Dose_f, data = df_sim_repro)</span></span>
<span id="cb44-739"><a href="#cb44-739" aria-hidden="true" tabindex="-1"></a><span class="in">summary(lm.repro)</span></span>
<span id="cb44-740"><a href="#cb44-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-741"><a href="#cb44-741" aria-hidden="true" tabindex="-1"></a><span class="in">dunnett.test.repro &lt;- glht(lm.repro, linfct = mcp(Dose_f = "Dunnett"))</span></span>
<span id="cb44-742"><a href="#cb44-742" aria-hidden="true" tabindex="-1"></a><span class="in">summary(dunnett.test.repro)</span></span>
<span id="cb44-743"><a href="#cb44-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-744"><a href="#cb44-744" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-745"><a href="#cb44-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-746"><a href="#cb44-746" aria-hidden="true" tabindex="-1"></a>D'après ces résultats, on en déduit que pour notre jeu de données :</span>
<span id="cb44-747"><a href="#cb44-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-748"><a href="#cb44-748" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>NOEC = 7.9 mg/L</span>
<span id="cb44-749"><a href="#cb44-749" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>LOEC = 25 mg/L</span>
<span id="cb44-750"><a href="#cb44-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-751"><a href="#cb44-751" aria-hidden="true" tabindex="-1"></a>Si une des hypothèses n'était pas vérifiée, on ferait :</span>
<span id="cb44-752"><a href="#cb44-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-755"><a href="#cb44-755" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb44-756"><a href="#cb44-756" aria-hidden="true" tabindex="-1"></a><span class="fu">kruskal.test</span>(Oeuf <span class="sc">~</span> Dose_f, <span class="at">data =</span> df_sim_repro)</span>
<span id="cb44-757"><a href="#cb44-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-758"><a href="#cb44-758" aria-hidden="true" tabindex="-1"></a>dunn.repro <span class="ot">&lt;-</span> <span class="fu">dunnTest</span>(Oeuf <span class="sc">~</span> Dose_f, <span class="at">data =</span> df_sim_repro, <span class="at">method =</span> <span class="st">"bonferroni"</span>)</span>
<span id="cb44-759"><a href="#cb44-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-760"><a href="#cb44-760" aria-hidden="true" tabindex="-1"></a>dunn_results <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(dunn.repro<span class="sc">$</span>res) </span>
<span id="cb44-761"><a href="#cb44-761" aria-hidden="true" tabindex="-1"></a>dunn_results <span class="sc">|&gt;</span> </span>
<span id="cb44-762"><a href="#cb44-762" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">select</span>(Comparison, P.adj)</span>
<span id="cb44-763"><a href="#cb44-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-764"><a href="#cb44-764" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb44-765"><a href="#cb44-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-766"><a href="#cb44-766" aria-hidden="true" tabindex="-1"></a>Ce test statistique nous permet pas de déterminer une NOEC et une LOEC. Cela est du à la plus faible puissance statistique d'un test non-paramétrique vs. paramétrique comme utilisé juste avant.</span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>