{
  "hash": "b4bc5c905a0d0672ab0edba214236840",
  "result": {
    "engine": "knitr",
    "markdown": "# Modélisation de la courbe dose-réponse - Exemple\n\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\nlibrary(tidyverse); library(drc); library(readxl); library(nord) # <1> \n\nNord_frost <- nord(palette = \"frost\")                            # <2> \nNord_aurora <- nord(palette = \"aurora\")                          # <2> \nNord_polar <- nord(palette = \"polarnight\")                       # <2> \nNord_snow <- nord(palette = \"snowstorm\")                         # <2> \n\ncol_croiss <- Nord_frost[2]                                      # <3>\ncol_repro <- Nord_frost[4]                                       # <3>\n```\n:::\n\n\n\n\n\n1. Packages utilisés ici\n2. Palettes de couleurs sympa qui vient d'ici : https://www.nordtheme.com\n3. Définition des couleurs pour nos endpoints\n\nOn s'intéresse à l'impact de la concentration en éther dans l'air (mg/L) sur la croissance et la reproduction des dragons. \n\n## Etape 1 - Importer et visualiser ses données\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\ndf_sim_croiss <- read_excel(here::here(\"data/Data_sim_croiss_dragon.xlsx\")) # <1>\ndf_sim_repro <- read_excel(here::here(\"data/Data_sim_repro_dragon.xlsx\"))   # <2>\n```\n:::\n\n\n\n\n\n1. Importation des données de croissance de nos dragons\n2. Importation des données de reproduction de nos dragons\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\nhead(df_sim_croiss) # <1>\nhead(df_sim_repro)  # <1>\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 4\n     ID  Dose nb_rep Txcroiss\n  <dbl> <dbl>  <dbl>    <dbl>\n1     1   5        1     29.4\n2     2   5        2     24.7\n3     3   5        3     30.7\n4     4   5        4     30.7\n5     5   5        5     29.4\n6     6  10.8      1     26.1\n# A tibble: 6 × 4\n     ID  Dose nb_rep  Oeuf\n  <dbl> <dbl>  <dbl> <dbl>\n1     1 0.25       1  20.9\n2     2 0.25       2  17.7\n3     3 0.25       3  23.2\n4     4 0.25       4  19.6\n5     5 0.25       5  20.2\n6     6 0.791      1  19  \n```\n\n\n:::\n:::\n\n\n\n\n\n1. Affiche les 5 premières lignes\n\nOn a des jeux de données avec :\n\n- `ID` : Numéro unique du dragon\n- `Nb_rep` : Numéro de réplicat par rapport à un dose donnée\n- `Dose` : Dose d'exposition du dragon (mg/L)\n- `Oeuf` : Le nombre d'oeuf produit par le dragon en 1 an\n- `Txcroiss` : Le taux de croissance du dragon (kg/jour)\n\nIl serait bien de d'avoir des jeux de donnée avec la moyenne du taux de croissance et la moyenne du nombre d'oeuf produit par dose testée. \n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"show\"}\ndf_sim_croiss_mean <- df_sim_croiss |>   # <1>\n  aggregate(Txcroiss ~ Dose, FUN = mean) # <1>\n\ndf_sim_repro_mean <- df_sim_repro |>    # <1>\n  aggregate(Oeuf ~ Dose, FUN = mean) # <1>\n\nhead(df_sim_croiss_mean)\nhead(df_sim_repro_mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       Dose Txcroiss\n1   5.00000  28.9708\n2  10.77217  28.3286\n3  23.20794  27.0730\n4  50.00000  20.7956\n5 107.72173  12.4822\n6 232.07944   1.4062\n        Dose  Oeuf\n1  0.2500000 20.32\n2  0.7905694 19.82\n3  2.5000000 16.58\n4  7.9056942 11.32\n5 25.0000000  5.70\n6 79.0569415  2.70\n```\n\n\n:::\n:::\n\n\n\n\n\n1. Creation de nouveaux dataframes avec le taux de croissance et le nombre d'oeufs produits moyen par dose.\n\n\n::: panel-tabset\n\n## Dots\n\nOn peut faire un graphique avec deux types de points : Les points correspondant aux réplicats et les points correspondant à la moyenne pour une dose donnée (@fig-datapoint). \n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Paramètres des graphiques \nsize_mean <- 3\nalpha_rep <- 0.5\n\np_C <- ggplot()+                                  # <1>\n  \n  # Nuage de points avec un point par réplicat\n  geom_point(\n      data = df_sim_croiss,                       # <2>\n      mapping = aes(                              # <3>\n        x = Dose,                                 # <3>\n        y = Txcroiss                              # <3>\n      ),                                          # <3>\n      alpha = alpha_rep,                          # <4>\n      color = col_croiss                          # <5>\n      )+\n  \n  # Nuage de points correspondant aux moyennes par dose\n  geom_point(\n      data = df_sim_croiss_mean,\n      mapping = aes(\n        x = Dose,\n        y = Txcroiss\n      ),\n      alpha = 1,\n      color = col_croiss,\n      size = size_mean                            # <6>\n      )+\n  \n  scale_x_log10()+                                # <7>\n  \n  labs(                                           # <8>\n    x = \"Dose en éther (mg/L)\",                   # <8>\n    y = \"Taux de croissance des dragons (kg/jour)\"# <8>\n  )+                                              # <8>\n  theme_minimal()                                 # <9>\n\np_R <- ggplot()+ \n  \n  # Nuage de points avec un point par réplicat\n  geom_point(\n      data = df_sim_repro, \n      mapping = aes( \n        x = Dose, \n        y = Oeuf \n      ), \n      alpha = alpha_rep, \n      color = col_repro\n      )+\n  \n  # Nuage de points correspondant aux moyennes par dose\n  geom_point(\n      data = df_sim_repro_mean,\n      mapping = aes(\n        x = Dose,\n        y = Oeuf\n      ),\n      alpha = 1,\n      color = col_repro,\n      size = size_mean\n      )+\n  \n  scale_x_log10()+\n  \n  labs( \n    x = \"Dose en éther (mg/L)\",\n    y = \"Nombre d'oeufs produits par les dragons (#)\"\n  )+\n  theme_minimal()\n\np <- p_C + p_R +                                  # <10>\n  plot_layout(ncol = 2)                           # <10>\np \n```\n\n::: {.cell-output-display}\n![Taux de croissance et production d'oeufs des dragons en fonction de la dose d'éther](A_Dose_response_curves_with_R_files/figure-html/fig-datapoint-1.png){#fig-datapoint width=768}\n:::\n:::\n\n\n\n\n\n1. Initialisation du graphique\n2. Données utilisées pour ce nuage de points\n3. Axes à utiliser pour ce nuage de points\n4. Transparence des points\n5. Couleur des points\n6. Taille des points pour ce nuage de points\n7. Axe des x mis en échelle log (logarithme base 10)\n8. Titres des axes\n9. Aspect général du graphique\n10. Les deux graphiques sont mis côte à côte\n\n## Boxplot\n\nOu on peut faire des bowplots, où la dose est bien une catégorie et non un nombre (@fig-databox).  \n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Paramètres des graphiques \nalpha_box <- 0.2\n\np_C <- ggplot(\n      data = df_sim_croiss,                    \n      mapping = aes(                          \n        x = as.factor(round(Dose,1)),                               \n        y = Txcroiss                           \n      )\n  )+                                  # <1>\n  \n  # Boxplot\n  geom_boxplot(\n      alpha = alpha_box,                          \n      color = col_croiss,                          \n      fill = col_croiss\n      )+\n  \n  # Points\n  geom_dotplot(\n    binaxis='y', \n    stackdir='center', \n    dotsize=0.7, \n    alpha=0.9,                          \n    color = col_croiss,\n    fill = col_croiss\n    )+\n  \n  labs(                                         \n    x = \"Dose en éther (mg/L)\",              \n    y = \"Taux de croissance des dragons (kg/jour)\"\n  )+                                             \n  theme_minimal() \n\np_R <- ggplot(\n      data = df_sim_repro,                    \n      mapping = aes(                          \n        x = as.factor(round(Dose,1)),                               \n        y = Oeuf                           \n      )\n  )+                                  # <1>\n  \n  # Boxplot\n  geom_boxplot(\n      alpha = alpha_box,                          \n      color = col_repro,                          \n      fill = col_repro\n      )+\n  \n  # Points\n  geom_dotplot(\n    binaxis='y', \n    stackdir='center', \n    dotsize=0.7, \n    alpha=0.9,                          \n    color = col_repro,\n    fill = col_repro\n    )+\n  \n  labs(                                         \n    x = \"Dose en éther (mg/L)\",              \n    y = \"Nombre d'oeufs produits par les dragons (#)\"\n  )+                                             \n  theme_minimal() \n\n\np <- p_C + p_R +                                \n  plot_layout(ncol = 2)                        \np \n```\n\n::: {.cell-output-display}\n![Taux de croissance et production d'oeufs des dragons en fonction de la dose d'éther](A_Dose_response_curves_with_R_files/figure-html/fig-databox-1.png){#fig-databox width=768}\n:::\n:::\n\n\n\n\n\n:::\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}